<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Graphics in R | Statistical Practice in Epidemiology with R</title>
  <meta name="description" content="This is the SPE-R 2024 exercises book" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Graphics in R | Statistical Practice in Epidemiology with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the SPE-R 2024 exercises book" />
  <meta name="github-repo" content="spe-r/spe" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Graphics in R | Statistical Practice in Epidemiology with R" />
  
  <meta name="twitter:description" content="This is the SPE-R 2024 exercises book" />
  

<meta name="author" content="Krista Fischer" />
<meta name="author" content="Martyn Plummer" />
<meta name="author" content="Janne Pitkäniemi" />
<meta name="author" content="Bendix Carstensen" />
<meta name="author" content="Damien Georges" />
<meta name="author" content="Esa Läärä" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tabulation.html"/>
<link rel="next" href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPE-R practicals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html"><i class="fa fa-check"></i><b>1</b> Practice with basic R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-working-directory"><i class="fa fa-check"></i><b>1.1</b> The working directory</a></li>
<li class="chapter" data-level="1.2" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-workspace"><i class="fa fa-check"></i><b>1.2</b> The workspace</a></li>
<li class="chapter" data-level="1.3" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.3</b> Using R as a calculator</a></li>
<li class="chapter" data-level="1.4" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#sequences"><i class="fa fa-check"></i><b>1.5</b> Sequences</a></li>
<li class="chapter" data-level="1.6" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#displaying-and-changing-parts-of-a-vector-indexing"><i class="fa fa-check"></i><b>1.6</b> Displaying and changing parts of a vector (indexing)</a></li>
<li class="chapter" data-level="1.7" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#lists"><i class="fa fa-check"></i><b>1.7</b> Lists</a></li>
<li class="chapter" data-level="1.8" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data frames</a></li>
<li class="chapter" data-level="1.9" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#working-with-built-in-data-frames"><i class="fa fa-check"></i><b>1.9</b> Working with built-in data frames</a></li>
<li class="chapter" data-level="1.10" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#referencing-parts-of-the-data-frame-indexing"><i class="fa fa-check"></i><b>1.10</b> Referencing parts of the data frame (indexing)</a></li>
<li class="chapter" data-level="1.11" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#summaries"><i class="fa fa-check"></i><b>1.11</b> Summaries</a></li>
<li class="chapter" data-level="1.12" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#generating-new-variables"><i class="fa fa-check"></i><b>1.12</b> Generating new variables</a></li>
<li class="chapter" data-level="1.13" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#turning-a-variable-into-a-factor"><i class="fa fa-check"></i><b>1.13</b> Turning a variable into a factor</a></li>
<li class="chapter" data-level="1.14" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#frequency-tables"><i class="fa fa-check"></i><b>1.14</b> Frequency tables</a></li>
<li class="chapter" data-level="1.15" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#grouping-the-values-of-a-numeric-variable"><i class="fa fa-check"></i><b>1.15</b> Grouping the values of a numeric variable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Reading data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-sources"><i class="fa fa-check"></i><b>2.2</b> Data sources</a></li>
<li class="chapter" data-level="2.3" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-in-text-files"><i class="fa fa-check"></i><b>2.3</b> Data in text files</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#things-that-can-go-wrong"><i class="fa fa-check"></i><b>2.4</b> Things that can go wrong</a></li>
<li class="chapter" data-level="2.5" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#forgetting-the-headers"><i class="fa fa-check"></i><b>2.5</b> Forgetting the headers</a></li>
<li class="chapter" data-level="2.6" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#using-the-wrong-separator"><i class="fa fa-check"></i><b>2.6</b> Using the wrong separator</a></li>
<li class="chapter" data-level="2.7" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#mis-specifying-the-representation-of-missing-values"><i class="fa fa-check"></i><b>2.7</b> Mis-specifying the representation of missing values</a></li>
<li class="chapter" data-level="2.8" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#spreadsheet-data"><i class="fa fa-check"></i><b>2.8</b> Spreadsheet data</a></li>
<li class="chapter" data-level="2.9" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-data-from-the-internet"><i class="fa fa-check"></i><b>2.9</b> Reading data from the Internet</a></li>
<li class="chapter" data-level="2.10" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-from-the-clipboard"><i class="fa fa-check"></i><b>2.10</b> Reading from the clipboard</a></li>
<li class="chapter" data-level="2.11" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#binary-data"><i class="fa fa-check"></i><b>2.11</b> Binary data</a></li>
<li class="chapter" data-level="2.12" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#summary"><i class="fa fa-check"></i><b>2.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#the-births-data"><i class="fa fa-check"></i><b>3.2</b> The <code>births</code> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#tibble-vs-data.frame"><i class="fa fa-check"></i><b>3.3</b> <code>tibble</code> vs <code>data.frame</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#piping-functions"><i class="fa fa-check"></i><b>3.4</b> Piping functions</a></li>
<li class="chapter" data-level="3.5" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#mutate-columns"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> columns</a></li>
<li class="chapter" data-level="3.6" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#select-columns-filter-and-arrange-rows"><i class="fa fa-check"></i><b>3.6</b> <code>select</code> columns, <code>filter</code> and <code>arrange</code> rows</a></li>
<li class="chapter" data-level="3.7" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#group_by-and-summarise-data"><i class="fa fa-check"></i><b>3.7</b> <code>group_by</code> and <code>summarise</code> data</a></li>
<li class="chapter" data-level="3.8" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#multiple-grouping"><i class="fa fa-check"></i><b>3.8</b> Multiple grouping</a></li>
<li class="chapter" data-level="3.9" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bind-and-join-tables"><i class="fa fa-check"></i><b>3.9</b> Bind and join tables</a></li>
<li class="chapter" data-level="3.10" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#data-visualization-with-ggplot2"><i class="fa fa-check"></i><b>3.10</b> Data Visualization with ggplot2</a></li>
<li class="chapter" data-level="3.11" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#pivoting-data-with-tidyr"><i class="fa fa-check"></i><b>3.11</b> pivoting data with tidyr</a></li>
<li class="chapter" data-level="3.12" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#reading-files-with-readr"><i class="fa fa-check"></i><b>3.12</b> reading files with readr</a></li>
<li class="chapter" data-level="3.13" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.13</b> String manipulation with stringr</a></li>
<li class="chapter" data-level="3.14" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#purrr-package-to-apply-functions-to-list"><i class="fa fa-check"></i><b>3.14</b> purrr package to apply functions to list</a></li>
<li class="chapter" data-level="3.15" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bonus-rendering-tables"><i class="fa fa-check"></i><b>3.15</b> Bonus: Rendering tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tabulation.html"><a href="tabulation.html"><i class="fa fa-check"></i><b>4</b> Tabulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tabulation.html"><a href="tabulation.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tabulation.html"><a href="tabulation.html#the-births-data-1"><i class="fa fa-check"></i><b>4.2</b> The births data</a></li>
<li class="chapter" data-level="4.3" data-path="tabulation.html"><a href="tabulation.html#one-way-tables"><i class="fa fa-check"></i><b>4.3</b> One-way tables</a></li>
<li class="chapter" data-level="4.4" data-path="tabulation.html"><a href="tabulation.html#improving-the-presentation-of-tables"><i class="fa fa-check"></i><b>4.4</b> Improving the Presentation of Tables</a></li>
<li class="chapter" data-level="4.5" data-path="tabulation.html"><a href="tabulation.html#two-way-tables"><i class="fa fa-check"></i><b>4.5</b> Two-way Tables</a></li>
<li class="chapter" data-level="4.6" data-path="tabulation.html"><a href="tabulation.html#printing"><i class="fa fa-check"></i><b>4.6</b> Printing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-in-r.html"><a href="graphics-in-r.html"><i class="fa fa-check"></i><b>5</b> Graphics in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#simple-plot-on-the-screen"><i class="fa fa-check"></i><b>5.1</b> Simple plot on the screen</a></li>
<li class="chapter" data-level="5.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#colours"><i class="fa fa-check"></i><b>5.2</b> Colours</a></li>
<li class="chapter" data-level="5.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#adding-to-a-plot"><i class="fa fa-check"></i><b>5.3</b> Adding to a plot</a></li>
<li class="chapter" data-level="5.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#using-indexing-for-plot-elements"><i class="fa fa-check"></i><b>5.4</b> Using indexing for plot elements</a></li>
<li class="chapter" data-level="5.5" data-path="graphics-in-r.html"><a href="graphics-in-r.html#generating-colours"><i class="fa fa-check"></i><b>5.5</b> Generating colours</a></li>
<li class="chapter" data-level="5.6" data-path="graphics-in-r.html"><a href="graphics-in-r.html#saving-your-graphs-for-use-in-other-documents"><i class="fa fa-check"></i><b>5.6</b> Saving your graphs for use in other documents</a></li>
<li class="chapter" data-level="5.7" data-path="graphics-in-r.html"><a href="graphics-in-r.html#interacting-with-a-plot"><i class="fa fa-check"></i><b>5.7</b> Interacting with a plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><i class="fa fa-check"></i><b>6</b> Analysis of hazard rates, their ratios and differences and binary regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#hand-calculations-for-a-single-rate"><i class="fa fa-check"></i><b>6.1</b> Hand calculations for a single rate</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-logarithmic-link"><i class="fa fa-check"></i><b>6.2</b> Poisson model for a single rate with logarithmic link</a></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-identity-link"><i class="fa fa-check"></i><b>6.3</b> Poisson model for a single rate with identity link</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-assuming-the-same-rate-for-several-periods"><i class="fa fa-check"></i><b>6.4</b> Poisson model assuming the same rate for several periods</a></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-ratio"><i class="fa fa-check"></i><b>6.5</b> Analysis of rate ratio</a></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-difference"><i class="fa fa-check"></i><b>6.6</b> Analysis of rate difference</a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#binary-regression"><i class="fa fa-check"></i><b>6.7</b> Binary regression</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#optionalhomework-hand-calculations-and-calculations-using-matrix-tools"><i class="fa fa-check"></i><b>6.8</b> Optional/Homework: Hand calculations and calculations using matrix tools</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html"><i class="fa fa-check"></i><b>7</b> Estimation of effects: simple and more complex</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#response-and-explanatory-variables"><i class="fa fa-check"></i><b>7.1</b> Response and explanatory variables</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#data-set-births"><i class="fa fa-check"></i><b>7.2</b> Data set <code>births</code></a></li>
<li class="chapter" data-level="7.3" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#simple-estimation-with-lm-and-glm"><i class="fa fa-check"></i><b>7.3</b> Simple estimation with <code>lm()</code> and <code>glm()</code></a></li>
<li class="chapter" data-level="7.4" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#stratified-effects-and-interaction-or-effect-measure-modification"><i class="fa fa-check"></i><b>7.4</b> Stratified effects, and interaction or effect-measure modification</a></li>
<li class="chapter" data-level="7.5" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#estimating-the-effect-of-hyp-adjusted-for-sex"><i class="fa fa-check"></i><b>7.5</b> Estimating the effect of <code>hyp</code> adjusted for <code>sex</code></a></li>
<li class="chapter" data-level="7.6" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#numeric-exposure-simple-linear-regression-and-checking-assumptions"><i class="fa fa-check"></i><b>7.6</b> Numeric exposure, simple linear regression and checking assumptions</a></li>
<li class="chapter" data-level="7.7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#penalized-spline-model"><i class="fa fa-check"></i><b>7.7</b> Penalized spline model</a></li>
<li class="chapter" data-level="7.8" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#analysis-of-binary-outcomes"><i class="fa fa-check"></i><b>7.8</b> Analysis of binary outcomes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html"><i class="fa fa-check"></i><b>8</b> Poisson regression &amp; analysis of curved effects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#testis-cancer-data-input-and-housekeeping"><i class="fa fa-check"></i><b>8.1</b> Testis cancer: Data input and housekeeping</a></li>
<li class="chapter" data-level="8.2" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#some-descriptive-analysis"><i class="fa fa-check"></i><b>8.2</b> Some descriptive analysis</a></li>
<li class="chapter" data-level="8.3" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#age-and-period-as-categorical-factors"><i class="fa fa-check"></i><b>8.3</b> Age and period as categorical factors</a></li>
<li class="chapter" data-level="8.4" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#generalized-additive-model-with-penalized-splines"><i class="fa fa-check"></i><b>8.4</b> Generalized additive model with penalized splines</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>9</b> Causal inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="causal-inference.html"><a href="causal-inference.html#proper-adjustment-for-confounding-in-regression-models"><i class="fa fa-check"></i><b>9.1</b> Proper adjustment for confounding in regression models</a></li>
<li class="chapter" data-level="9.2" data-path="causal-inference.html"><a href="causal-inference.html#dag-tools-in-the-package-dagitty"><i class="fa fa-check"></i><b>9.2</b> DAG tools in the package <code>dagitty</code></a></li>
<li class="chapter" data-level="9.3" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variables-estimation-mendelian-randomization"><i class="fa fa-check"></i><b>9.3</b> Instrumental variables estimation: Mendelian randomization</a></li>
<li class="chapter" data-level="9.4" data-path="causal-inference.html"><a href="causal-inference.html#why-are-simulation-exercises-useful-for-causal-inference"><i class="fa fa-check"></i><b>9.4</b> Why are simulation exercises useful for causal inference?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>10</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#data"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#building-the-plot"><i class="fa fa-check"></i><b>10.2</b> Building the plot</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#the-ggplot2-package"><i class="fa fa-check"></i><b>10.2.1</b> The ggplot2 package</a></li>
<li class="chapter" data-level="10.2.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#geometries"><i class="fa fa-check"></i><b>10.2.2</b> Geometries</a></li>
<li class="chapter" data-level="10.2.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>10.2.3</b> Scales</a></li>
<li class="chapter" data-level="10.2.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>10.2.4</b> Themes</a></li>
<li class="chapter" data-level="10.2.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#putting-everything-together"><i class="fa fa-check"></i><b>10.2.5</b> Putting everything together</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#self-study"><i class="fa fa-check"></i><b>10.3</b> Self study</a></li>
<li class="chapter" data-level="10.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-the-table-advanced-topic"><i class="fa fa-check"></i><b>10.4</b> Adding the table (advanced topic)</a></li>
<li class="chapter" data-level="10.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#references"><i class="fa fa-check"></i><b>10.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html"><i class="fa fa-check"></i><b>11</b> Survival analysis with competing risks: Oral cancer patients</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#description-of-the-data"><i class="fa fa-check"></i><b>11.1</b> Description of the data</a></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#loading-the-packages-and-the-data"><i class="fa fa-check"></i><b>11.2</b> Loading the packages and the data</a></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-kaplanmeier-analyses"><i class="fa fa-check"></i><b>11.3</b> Total mortality: Kaplan–Meier analyses</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-by-stage"><i class="fa fa-check"></i><b>11.4</b> Total mortality by stage</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#event-specific-cumulative-mortality-curves"><i class="fa fa-check"></i><b>11.5</b> Event-specific cumulative mortality curves</a></li>
<li class="chapter" data-level="11.6" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#regression-modelling-of-overall-mortality."><i class="fa fa-check"></i><b>11.6</b> Regression modelling of overall mortality.</a></li>
<li class="chapter" data-level="11.7" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#modelling-event-specific-hazards"><i class="fa fa-check"></i><b>11.7</b> Modelling event-specific hazards</a></li>
<li class="chapter" data-level="11.8" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#lexis-object-with-multi-state-set-up"><i class="fa fa-check"></i><b>11.8</b> Lexis object with multi-state set-up</a></li>
<li class="chapter" data-level="11.9" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#optional-poisson-regression-as-an-alternative-to-cox-model"><i class="fa fa-check"></i><b>11.9</b> Optional: Poisson regression as an alternative to Cox model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html"><i class="fa fa-check"></i><b>12</b> Time-splitting, time-scales and SMR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#age-specific-mortality"><i class="fa fa-check"></i><b>12.1</b> Age-specific mortality</a></li>
<li class="chapter" data-level="12.2" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr"><i class="fa fa-check"></i><b>12.2</b> SMR</a></li>
<li class="chapter" data-level="12.3" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr-modeling"><i class="fa fa-check"></i><b>12.3</b> SMR modeling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><i class="fa fa-check"></i><b>13</b> Nested case-control study and case-cohort study: Risk factors of coronary heart disease</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#reading-the-cohort-data-illustrating-the-study-base-and-risk-sets"><i class="fa fa-check"></i><b>13.1</b> Reading the cohort data, illustrating the study base and risk sets</a></li>
<li class="chapter" data-level="13.2" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#nested-case-control-study"><i class="fa fa-check"></i><b>13.2</b> Nested case-control study</a></li>
<li class="chapter" data-level="13.3" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#case-cohort-study"><i class="fa fa-check"></i><b>13.3</b> Case-cohort study</a></li>
<li class="chapter" data-level="13.4" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#do-these-estimates-resemble-those-obtained-from-nested-case-control-data"><i class="fa fa-check"></i><b>13.4</b> Do these estimates resemble those obtained from nested case-control data?</a></li>
<li class="chapter" data-level="13.5" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#full-cohort-analysis-and-comparisons"><i class="fa fa-check"></i><b>13.5</b> Full cohort analysis and comparisons</a></li>
<li class="chapter" data-level="13.6" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#further-exercises-and-homework"><i class="fa fa-check"></i><b>13.6</b> Further exercises and homework</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html"><i class="fa fa-check"></i><b>14</b> Causal inference 2: Model-based estimation of causal estimands</a>
<ul>
<li class="chapter" data-level="14.1" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#introduction-3"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#control-of-confounding"><i class="fa fa-check"></i><b>14.2</b> Control of confounding</a></li>
<li class="chapter" data-level="14.3" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#generation-of-target-population-and-true-models"><i class="fa fa-check"></i><b>14.3</b> Generation of target population and true models</a></li>
<li class="chapter" data-level="14.4" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#factual-and-counterfactual-risks---associational-and-causal-contrasts"><i class="fa fa-check"></i><b>14.4</b> Factual and counterfactual risks - associational and causal contrasts</a></li>
<li class="chapter" data-level="14.5" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#outcome-modelling-and-estimation-of-causal-contrasts-by-g-formula"><i class="fa fa-check"></i><b>14.5</b> Outcome modelling and estimation of causal contrasts by g-formula</a></li>
<li class="chapter" data-level="14.6" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#inverse-probability-weighting-ipw-by-propensity-scores"><i class="fa fa-check"></i><b>14.6</b> Inverse probability weighting (IPW) by propensity scores</a></li>
<li class="chapter" data-level="14.7" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#improving-ipw-estimation-and-using-r-package-psweight"><i class="fa fa-check"></i><b>14.7</b> Improving IPW estimation and using R package <code>PSweight</code></a></li>
<li class="chapter" data-level="14.8" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#effect-of-exposure-among-those-exposed"><i class="fa fa-check"></i><b>14.8</b> Effect of exposure among those exposed</a></li>
<li class="chapter" data-level="14.9" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#double-robust-estimation-by-augmented-ipw"><i class="fa fa-check"></i><b>14.9</b> Double robust estimation by augmented IPW</a></li>
<li class="chapter" data-level="14.10" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#double-robust-targeted-maximum-likelihood-estimation-tmle"><i class="fa fa-check"></i><b>14.10</b> Double robust, targeted maximum likelihood estimation (TMLE)</a></li>
<li class="chapter" data-level="14.11" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#double-robust-estimation-with-aipw-and-tmle-packages"><i class="fa fa-check"></i><b>14.11</b> Double robust estimation with <code>AIPW</code> and <code>tmle</code> packages</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html"><i class="fa fa-check"></i><b>15</b> Time-dependent variables and multiple states</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html#the-renal-failure-dataset"><i class="fa fa-check"></i><b>15.1</b> The renal failure dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/SPE-R/SPE" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Practice in Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics-in-r" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Graphics in R<a href="graphics-in-r.html#graphics-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>There are three kinds of plotting functions in R:</p>
<ul>
<li>Functions that generate a new plot, e.g. <code>hist()</code> and
<code>plot()</code>.</li>
<li>Functions that add extra things to an existing plot,
e.g. <code>lines()</code> and <code>text()</code>.</li>
<li>Functions that allow you to interact with the plot, e.g.
<code>locator()</code> and <code>identify()</code>.</li>
</ul>
<p>The normal procedure for making a graph in R is to make a fairly
simple initial plot and then add on points, lines, text etc.,
preferably in a script.</p>
<div id="simple-plot-on-the-screen" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Simple plot on the screen<a href="graphics-in-r.html#simple-plot-on-the-screen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the births data and get an overview of the variables:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="graphics-in-r.html#cb348-1" tabindex="-1"></a><span class="fu">library</span>(Epi)</span>
<span id="cb348-2"><a href="graphics-in-r.html#cb348-2" tabindex="-1"></a><span class="fu">data</span>(births)</span>
<span id="cb348-3"><a href="graphics-in-r.html#cb348-3" tabindex="-1"></a><span class="fu">str</span>(births)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  8 variables:
##  $ id     : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ bweight: num  2974 3270 2620 3751 3200 ...
##  $ lowbw  : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ gestwks: num  38.5 NA 38.2 39.8 38.9 ...
##  $ preterm: num  0 NA 0 0 0 0 0 0 0 0 ...
##  $ matage : num  34 30 35 31 33 33 29 37 36 39 ...
##  $ hyp    : num  0 0 0 0 1 0 0 0 0 0 ...
##  $ sex    : num  2 1 2 1 1 2 2 1 2 1 ...</code></pre>
<p>Now look at the birth weight distribution with</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="graphics-in-r.html#cb350-1" tabindex="-1"></a><span class="fu">hist</span>(births<span class="sc">$</span>bweight)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-3-1.png" width="672" />
The histogram can be refined – take a look at the possible options with</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="graphics-in-r.html#cb351-1" tabindex="-1"></a><span class="fu">help</span>(hist)</span></code></pre></div>
<p>and try some of the options, for example:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="graphics-in-r.html#cb352-1" tabindex="-1"></a><span class="fu">hist</span>(births<span class="sc">$</span>bweight, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-5-1.png" width="672" />
To look at the relationship between birthweight and gestational weeks, try</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="graphics-in-r.html#cb353-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight))</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-6-1.png" width="672" />
You can change the plot-symbol by the option <code>pch=</code>. If you
want to see all the plot symbols try:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="graphics-in-r.html#cb354-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ul>
<li>Make a plot of the birth weight versus maternal age with</li>
</ul>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="graphics-in-r.html#cb355-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(matage, bweight))</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-8-1.png" width="672" />
- Label the axes with</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="graphics-in-r.html#cb356-1" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb356-2"><a href="graphics-in-r.html#cb356-2" tabindex="-1"></a>  births, </span>
<span id="cb356-3"><a href="graphics-in-r.html#cb356-3" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb356-4"><a href="graphics-in-r.html#cb356-4" tabindex="-1"></a>    matage, </span>
<span id="cb356-5"><a href="graphics-in-r.html#cb356-5" tabindex="-1"></a>    bweight, </span>
<span id="cb356-6"><a href="graphics-in-r.html#cb356-6" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Maternal age&quot;</span>, </span>
<span id="cb356-7"><a href="graphics-in-r.html#cb356-7" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Birth weight (g)&quot;</span></span>
<span id="cb356-8"><a href="graphics-in-r.html#cb356-8" tabindex="-1"></a>  )</span>
<span id="cb356-9"><a href="graphics-in-r.html#cb356-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="colours" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Colours<a href="graphics-in-r.html#colours" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many colours recognized by <code>R</code>. You can list them all by
<code>colours()</code> or, equivalently, <code>colors()</code> (<code>R</code> allows you to
use British or American spelling). To colour the points of birthweight
versus gestational weeks, try</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="graphics-in-r.html#cb357-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-10-1.png" width="672" />
This creates a solid mass of colour in the centre of the cluster of
points and it is no longer possible to see individual points. You can
recover this information by overwriting the points with black circles
using the <code>points()</code> function.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="graphics-in-r.html#cb358-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>))</span>
<span id="cb358-2"><a href="graphics-in-r.html#cb358-2" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">points</span>(gestwks, bweight, <span class="at">pch =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-11-1.png" width="672" />
Note: when the number of data points on a scatter plot is large, you may also want to decrease the point size: to get points that are 50% of the original size, add the parameter <code>cex=0.5</code> (or another number &lt;1 for different sizes).</p>
</div>
<div id="adding-to-a-plot" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Adding to a plot<a href="graphics-in-r.html#adding-to-a-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>points()</code> function just used is one of several functions
that add elements to an existing plot. By using these functions, you
can create quite complex graphs in small steps.</p>
<p>Suppose we wish to recreate the plot of birthweight <em>vs</em> gestational
weeks using different colours for male and female babies. To start with
an empty plot, with <code>type='n'</code> argument.</p>
<p>Then add the points with the <code>points</code> function.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="graphics-in-r.html#cb359-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb359-2"><a href="graphics-in-r.html#cb359-2" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb359-3"><a href="graphics-in-r.html#cb359-3" tabindex="-1"></a>  births, </span>
<span id="cb359-4"><a href="graphics-in-r.html#cb359-4" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">1</span>], bweight[sex <span class="sc">==</span> <span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb359-5"><a href="graphics-in-r.html#cb359-5" tabindex="-1"></a>)</span>
<span id="cb359-6"><a href="graphics-in-r.html#cb359-6" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb359-7"><a href="graphics-in-r.html#cb359-7" tabindex="-1"></a>  births, </span>
<span id="cb359-8"><a href="graphics-in-r.html#cb359-8" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">2</span>], bweight[sex <span class="sc">==</span> <span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb359-9"><a href="graphics-in-r.html#cb359-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>To add a legend explaining the colours, try</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="graphics-in-r.html#cb360-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb360-2"><a href="graphics-in-r.html#cb360-2" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb360-3"><a href="graphics-in-r.html#cb360-3" tabindex="-1"></a>  births, </span>
<span id="cb360-4"><a href="graphics-in-r.html#cb360-4" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">1</span>], bweight[sex <span class="sc">==</span> <span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb360-5"><a href="graphics-in-r.html#cb360-5" tabindex="-1"></a>)</span>
<span id="cb360-6"><a href="graphics-in-r.html#cb360-6" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb360-7"><a href="graphics-in-r.html#cb360-7" tabindex="-1"></a>  births, </span>
<span id="cb360-8"><a href="graphics-in-r.html#cb360-8" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">2</span>], bweight[sex <span class="sc">==</span> <span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb360-9"><a href="graphics-in-r.html#cb360-9" tabindex="-1"></a>)</span>
<span id="cb360-10"><a href="graphics-in-r.html#cb360-10" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb360-11"><a href="graphics-in-r.html#cb360-11" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb360-12"><a href="graphics-in-r.html#cb360-12" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span>, </span>
<span id="cb360-13"><a href="graphics-in-r.html#cb360-13" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Boys&quot;</span>, <span class="st">&quot;Girls&quot;</span>), </span>
<span id="cb360-14"><a href="graphics-in-r.html#cb360-14" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb360-15"><a href="graphics-in-r.html#cb360-15" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-13-1.png" width="672" />
which puts the legend in the top left hand corner.</p>
<p>Finally we can add a title to the plot with</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="graphics-in-r.html#cb361-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>))</span>
<span id="cb361-2"><a href="graphics-in-r.html#cb361-2" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb361-3"><a href="graphics-in-r.html#cb361-3" tabindex="-1"></a>  births, </span>
<span id="cb361-4"><a href="graphics-in-r.html#cb361-4" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">1</span>], bweight[sex <span class="sc">==</span> <span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb361-5"><a href="graphics-in-r.html#cb361-5" tabindex="-1"></a>)</span>
<span id="cb361-6"><a href="graphics-in-r.html#cb361-6" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb361-7"><a href="graphics-in-r.html#cb361-7" tabindex="-1"></a>  births, </span>
<span id="cb361-8"><a href="graphics-in-r.html#cb361-8" tabindex="-1"></a>  <span class="fu">points</span>(gestwks[sex <span class="sc">==</span> <span class="dv">2</span>], bweight[sex <span class="sc">==</span> <span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb361-9"><a href="graphics-in-r.html#cb361-9" tabindex="-1"></a>)</span>
<span id="cb361-10"><a href="graphics-in-r.html#cb361-10" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb361-11"><a href="graphics-in-r.html#cb361-11" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb361-12"><a href="graphics-in-r.html#cb361-12" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span>, </span>
<span id="cb361-13"><a href="graphics-in-r.html#cb361-13" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Boys&quot;</span>, <span class="st">&quot;Girls&quot;</span>), </span>
<span id="cb361-14"><a href="graphics-in-r.html#cb361-14" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb361-15"><a href="graphics-in-r.html#cb361-15" tabindex="-1"></a>)</span>
<span id="cb361-16"><a href="graphics-in-r.html#cb361-16" tabindex="-1"></a><span class="fu">title</span>(</span>
<span id="cb361-17"><a href="graphics-in-r.html#cb361-17" tabindex="-1"></a>  <span class="st">&quot;Birth weight vs gestational weeks in 500 singleton births&quot;</span></span>
<span id="cb361-18"><a href="graphics-in-r.html#cb361-18" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="using-indexing-for-plot-elements" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Using indexing for plot elements<a href="graphics-in-r.html#using-indexing-for-plot-elements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the most powerful features of R is the possibility to index
vectors, not only to get subsets of them, but also for repeating their
elements in complex sequences.</p>
<p>Putting separate colours on males and female as above would become
very clumsy if we had a 5 level factor instead of sex.</p>
<p>Instead of specifying one color for all points, we may specify a
vector of colours of the same length as the <code>gestwks</code> and
<code>bweight</code> vectors. This is rather tedious to do directly, but R
allows you to specify an expression anywhere, so we can use the fact
that <code>sex</code> takes the values 1 and 2, as follows:</p>
<p>First create a colour vector with two colours,
and take look at <code>sex</code>:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="graphics-in-r.html#cb362-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;blue&quot; &quot;red&quot;</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="graphics-in-r.html#cb364-1" tabindex="-1"></a>births<span class="sc">$</span>sex</span></code></pre></div>
<pre><code>##   [1] 2 1 2 1 1 2 2 1 2 1 1 2 2 1 2 1 2 1 2 2 2 1 2 2 2 1 2 1 2 1 2 2 1 1 2 2 1
##  [38] 1 2 1 2 1 1 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 1 1 2 1 1 2 1 1 2 2 1 2 1 1 1 1
##  [75] 1 2 1 1 2 1 2 1 1 2 1 1 1 2 1 1 1 2 1 2 1 1 2 1 2 2 2 2 2 2 2 1 1 2 2 2 1
## [112] 2 2 1 2 2 2 2 1 1 2 1 1 2 1 1 2 1 2 1 1 1 1 2 1 2 1 1 1 2 1 2 2 1 1 1 2 2
## [149] 2 2 2 2 1 2 1 1 2 1 1 2 2 1 2 1 1 1 1 1 2 1 1 2 2 1 1 1 2 2 2 2 1 2 1 2 1
## [186] 1 2 2 1 2 2 1 2 1 2 2 2 2 1 1 1 2 1 1 2 1 1 1 1 2 2 2 2 2 1 1 2 1 2 2 2 1
## [223] 2 1 1 1 1 2 1 2 2 2 1 2 2 2 1 1 2 1 1 2 1 2 2 2 1 1 2 2 2 2 1 1 1 2 2 1 2
## [260] 2 2 2 1 1 1 1 1 1 2 1 2 1 2 2 2 2 2 1 1 1 2 2 2 1 2 1 2 1 2 1 1 1 2 2 2 2
## [297] 1 2 1 1 2 1 2 1 1 2 1 2 1 2 2 1 1 2 1 1 2 1 1 2 2 1 1 1 1 2 2 2 2 1 1 1 1
## [334] 2 1 1 2 2 1 2 2 1 1 2 1 1 2 1 2 1 1 1 1 2 1 1 2 2 2 1 1 1 1 1 1 2 2 2 2 2
## [371] 1 1 2 1 1 2 1 2 1 1 1 2 2 1 1 2 1 1 1 2 1 1 1 1 1 1 1 2 2 1 2 2 1 2 2 1 1
## [408] 2 2 1 1 2 1 1 2 1 2 1 2 2 1 1 2 2 1 2 2 2 2 1 1 2 2 2 2 2 2 1 2 1 1 2 2 1
## [445] 1 1 2 2 2 2 1 2 2 2 2 1 1 2 1 2 1 1 1 1 2 1 1 1 2 1 2 1 1 1 1 2 2 1 2 1 2
## [482] 2 1 1 2 2 1 1 1 1 2 2 2 1 1 2 1 2 2 1</code></pre>
<p>Now see what happens if you index the colour vector by sex:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="graphics-in-r.html#cb366-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[births<span class="sc">$</span>sex]</span></code></pre></div>
<pre><code>##   [1] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
##  [11] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
##  [21] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
##  [31] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
##  [41] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot;
##  [51] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot;
##  [61] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
##  [71] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
##  [81] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot;
##  [91] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
## [101] &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot; 
## [111] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot;
## [121] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [131] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot; 
## [141] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot; 
## [151] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot; 
## [161] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [171] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot; 
## [181] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
## [191] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot;
## [201] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot; 
## [211] &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
## [221] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
## [231] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [241] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
## [251] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
## [261] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [271] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot;
## [281] &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [291] &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot;
## [301] &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
## [311] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot; 
## [321] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;
## [331] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
## [341] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [351] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;
## [361] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot; 
## [371] &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot;
## [381] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot; 
## [391] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;
## [401] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;
## [411] &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot; 
## [421] &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;
## [431] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [441] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot; 
## [451] &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot; 
## [461] &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [471] &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;blue&quot;
## [481] &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;blue&quot; &quot;blue&quot;
## [491] &quot;red&quot;  &quot;red&quot;  &quot;red&quot;  &quot;blue&quot; &quot;blue&quot; &quot;red&quot;  &quot;blue&quot; &quot;red&quot;  &quot;red&quot;  &quot;blue&quot;</code></pre>
<p>For every occurrence of a <code>1</code> in <code>sex</code> you get
<code>"blue"</code>, and for every occurrence of <code>2</code> you get
<code>"red"</code>, so the result is a long vector of <code>"blue"</code>s and
<code>"red"</code>s corresponding to the males and females.
This can now be used in the plot:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="graphics-in-r.html#cb368-1" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb368-2"><a href="graphics-in-r.html#cb368-2" tabindex="-1"></a>  births, </span>
<span id="cb368-3"><a href="graphics-in-r.html#cb368-3" tabindex="-1"></a>  <span class="fu">plot</span>(gestwks, bweight, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[sex])</span>
<span id="cb368-4"><a href="graphics-in-r.html#cb368-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-17-1.png" width="672" />
The same trick can be used if we want to have a separate symbol for
mothers over 40 say. We first generate the indexing variable:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="graphics-in-r.html#cb369-1" tabindex="-1"></a>births<span class="sc">$</span>oldmum <span class="ot">&lt;-</span> (births<span class="sc">$</span>matage <span class="sc">&gt;=</span> <span class="dv">40</span>) <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>Note we add 1 because <code>( matage &gt;= 40 )</code> generates a logic
variable, so by adding 1 we get a numeric variable with values 1 and
2, suitable for indexing:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="graphics-in-r.html#cb370-1" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb370-2"><a href="graphics-in-r.html#cb370-2" tabindex="-1"></a>  births, </span>
<span id="cb370-3"><a href="graphics-in-r.html#cb370-3" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb370-4"><a href="graphics-in-r.html#cb370-4" tabindex="-1"></a>    gestwks, </span>
<span id="cb370-5"><a href="graphics-in-r.html#cb370-5" tabindex="-1"></a>    bweight, </span>
<span id="cb370-6"><a href="graphics-in-r.html#cb370-6" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">3</span>)[oldmum], </span>
<span id="cb370-7"><a href="graphics-in-r.html#cb370-7" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[sex]</span>
<span id="cb370-8"><a href="graphics-in-r.html#cb370-8" tabindex="-1"></a>  )</span>
<span id="cb370-9"><a href="graphics-in-r.html#cb370-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-19-1.png" width="672" />
so where <code>oldmum</code> is 1 we get <code>pch=16</code> (a dot) and where
<code>oldmum</code> is 2 we get <code>pch=3</code> (a cross).</p>
<p>R will accept any kind of complexity in the indexing as
long as the result is a valid index, so you don’t need to create the
variable <code>oldmum</code>, you can create it on the fly:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="graphics-in-r.html#cb371-1" tabindex="-1"></a><span class="fu">with</span>(</span>
<span id="cb371-2"><a href="graphics-in-r.html#cb371-2" tabindex="-1"></a>  births, </span>
<span id="cb371-3"><a href="graphics-in-r.html#cb371-3" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb371-4"><a href="graphics-in-r.html#cb371-4" tabindex="-1"></a>    gestwks, </span>
<span id="cb371-5"><a href="graphics-in-r.html#cb371-5" tabindex="-1"></a>    bweight, </span>
<span id="cb371-6"><a href="graphics-in-r.html#cb371-6" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">3</span>)[(matage <span class="sc">&gt;=</span> <span class="dv">40</span>) <span class="sc">+</span> <span class="dv">1</span>], </span>
<span id="cb371-7"><a href="graphics-in-r.html#cb371-7" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[sex]</span>
<span id="cb371-8"><a href="graphics-in-r.html#cb371-8" tabindex="-1"></a>  )</span>
<span id="cb371-9"><a href="graphics-in-r.html#cb371-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<!---
-  Make a three level factor for maternal age with cutpoints at
 30 and 40 years using the `cut` function.  (Recall that the
  `breaks` argument must include lower and upper limits beyond
 the range of the data, or you will get some missing values).
-  Use this to make the plot of bweight versus gestational weeks with three
  different plotting symbols. (Hint: Indexing with a factor
automatically gives indexes 1,2,3 etc.).
-->
</div>
<div id="generating-colours" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Generating colours<a href="graphics-in-r.html#generating-colours" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has functions that generate a vector of colours for you. For example,</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="graphics-in-r.html#cb372-1" tabindex="-1"></a><span class="fu">rainbow</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#FF0000&quot; &quot;#80FF00&quot; &quot;#00FFFF&quot; &quot;#8000FF&quot;</code></pre>
<p>produces a vector with 4 colours (not immediately human readable,
though). There are a few other functions that generates other
sequences of colours, type <code>?rainbow</code> to see them. The
<code>color</code> function (or <code>colour</code> function if you prefer)
returns a vector of the colour names that R knows about. These
names can also be used to specify colours.</p>
<p>Gray-tones are produced by the function <code>gray</code> (or
<code>grey</code>), which takes a numerical argument between 0 and 1;
<code>gray(0)</code> is black and <code>gray(1)</code> is white. Try:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="graphics-in-r.html#cb374-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">gray</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>))</span>
<span id="cb374-2"><a href="graphics-in-r.html#cb374-2" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="saving-your-graphs-for-use-in-other-documents" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Saving your graphs for use in other documents<a href="graphics-in-r.html#saving-your-graphs-for-use-in-other-documents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you need to use the plot in a report or presentation, you can save it in a graphics file.
Once you have generated the script (sequence of R commands) that produce the graph (and it looks ok on screen),
you can start a non-interactive graphics device and then re-run the script.
Instead of appearing on the screen, the plot will now be written
directly to a file. After the plot has been completed you will need
to close the device again in order to be able to access the file. Try:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="graphics-in-r.html#cb375-1" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;bweight_gwks.pdf&quot;</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">4</span>)</span>
<span id="cb375-2"><a href="graphics-in-r.html#cb375-2" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[sex]))</span>
<span id="cb375-3"><a href="graphics-in-r.html#cb375-3" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb375-4"><a href="graphics-in-r.html#cb375-4" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb375-5"><a href="graphics-in-r.html#cb375-5" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span>, </span>
<span id="cb375-6"><a href="graphics-in-r.html#cb375-6" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Boys&quot;</span>, <span class="st">&quot;Girls&quot;</span>), </span>
<span id="cb375-7"><a href="graphics-in-r.html#cb375-7" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb375-8"><a href="graphics-in-r.html#cb375-8" tabindex="-1"></a>)</span>
<span id="cb375-9"><a href="graphics-in-r.html#cb375-9" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>This will give you a portable document file <code>bweight_gwks.pdf</code> with a graph
which is 4 inches tall and 4 inches wide.</p>
<p>Instead of <em>pdf</em>, other formats can be used (<em>jpg, png, tiff, …</em>). See <code>help(Devices)</code> for the available options.</p>
<p>In window-based environments (R GUI for Windows, R-Studio) you may also use the menu
(<code>File</code><span class="math inline">\(\rightarrow\)</span><code>Save as ...</code> or <code>Export</code>) to save the active graph as a file and even copy-paste may work (from R graphics window to Word, for instance) – however, writing it manually into the file is recommended for reproducibility purposes (in case you need to redraw your graph with some modifications).</p>
<p>It is possible to manipulate any element in a graph, by using the
graphics options. These are collected on the help page of
<code>par()</code>. For example, if you want axis labels always to be
horizontal, use the command <code>par(las=1)</code>. This will be in
effect until a new graphics device is opened.</p>
<p>Look at the typewriter-version of the help-page with</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="graphics-in-r.html#cb376-1" tabindex="-1"></a><span class="fu">help</span>(par)</span></code></pre></div>
<p>or better, use the the html-version through
<code>Help</code> <span class="math inline">\(\rightarrow\)</span> <code>Html help</code> <span class="math inline">\(\rightarrow\)</span>
<code>Packages</code> <span class="math inline">\(\rightarrow\)</span> <code>graphics</code> <span class="math inline">\(\rightarrow\)</span>
<code>P</code><span class="math inline">\(\rightarrow\)</span> <code>par</code>.</p>
<p>It is a good idea to take a print of this (having set the text
size to <em>smallest</em> because it is long) and carry it with you at any
time to read in buses, cinema queues, during boring lectures etc.
Don’t despair, few R-users can understand what all the options are
for.</p>
<p><code>par()</code> can also be used to ask about the current plot, for
example <code>par("usr")</code> will give you the exact extent of the axes
in the current plot.</p>
<p>If you want more plots on a single page you can use the command</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="graphics-in-r.html#cb377-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p>This will give you a layout of 2 rows by 3 columns for the next 6
graphs you produce. The plots will appear by row, i.e. in the top
row first. If you want the plots to appear columnwise, use
<code>par( mfcol=c(2,3) )</code> (you still get 2 rows by 3 columns).</p>
<p>To restore the layout to a single plot per page use</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="graphics-in-r.html#cb378-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>If you want a more detailed control over the layout of multiple graphs
on a single page look at <code>?layout</code>.</p>
</div>
<div id="interacting-with-a-plot" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Interacting with a plot<a href="graphics-in-r.html#interacting-with-a-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>locator()</code> function allows you to interact with the plot
using the mouse. Typing <code>locator(1)</code> shifts you to the graphics
window and waits for one click of the left mouse button. When you click,
it will return the corresponding coordinates.</p>
<p>You can use <code>locator()</code> inside other graphics functions to position
graphical elements exactly where you want them. Recreate the birth-weight
plot,</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="graphics-in-r.html#cb379-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">plot</span>(gestwks, bweight, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)[sex]))</span></code></pre></div>
<p><img src="graph-intro-s_files/figure-html/unnamed-chunk-27-1.png" width="672" />
and then add the legend where you wish it to appear by typing</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="graphics-in-r.html#cb380-1" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb380-2"><a href="graphics-in-r.html#cb380-2" tabindex="-1"></a>  <span class="fu">locator</span>(<span class="dv">1</span>), </span>
<span id="cb380-3"><a href="graphics-in-r.html#cb380-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span>, </span>
<span id="cb380-4"><a href="graphics-in-r.html#cb380-4" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Boys&quot;</span>, <span class="st">&quot;Girls&quot;</span>), </span>
<span id="cb380-5"><a href="graphics-in-r.html#cb380-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb380-6"><a href="graphics-in-r.html#cb380-6" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>identify()</code> function allows you to find out which records
in the data correspond to points on the graph. Try</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="graphics-in-r.html#cb381-1" tabindex="-1"></a><span class="fu">with</span>(births, <span class="fu">identify</span>(gestwks, bweight))</span></code></pre></div>
<p>When you click the left mouse button, a label will appear on the graph
identifying the row number of the nearest point in the data frame
<code>births</code>. If there is no point nearby, <code>R</code> will print a warning
message on the console instead. To end the interaction with the
graphics window, right click the mouse: the <code>identify</code> function
returns a vector of identified points.</p>
<ul>
<li>Use <code>identify()</code> to find which records correspond to the
smallest and largest number of gestational weeks and view the
corresponding records:</li>
</ul>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="graphics-in-r.html#cb382-1" tabindex="-1"></a><span class="fu">with</span>(births, births[<span class="fu">identify</span>(gestwks, bweight), ])</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tabulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SPE-R/SPE/edit/master/pracs-book/graph-intro-s.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPE-R-2024-practicals-with-solutions.pdf", "SPE-R-2024-practicals-with-solutions.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
