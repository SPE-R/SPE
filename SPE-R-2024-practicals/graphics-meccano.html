<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Graphics meccano | Statistical Practice in Epidemiology with R</title>
  <meta name="description" content="This is the SPE-R 2024 exercises book" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Graphics meccano | Statistical Practice in Epidemiology with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the SPE-R 2024 exercises book" />
  <meta name="github-repo" content="spe-r/spe" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Graphics meccano | Statistical Practice in Epidemiology with R" />
  
  <meta name="twitter:description" content="This is the SPE-R 2024 exercises book" />
  

<meta name="author" content="Krista Fischer" />
<meta name="author" content="Martyn Plummer" />
<meta name="author" content="Janne Pitkäniemi" />
<meta name="author" content="Bendix Carstensen" />
<meta name="author" content="Damien Georges" />
<meta name="author" content="Esa Läärä" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="causal-inference.html"/>
<link rel="next" href="survival-analysis-with-competing-risks-oral-cancer-patients.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPE-R practicals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html"><i class="fa fa-check"></i><b>1</b> Practice with basic R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-working-directory"><i class="fa fa-check"></i><b>1.1</b> The working directory</a></li>
<li class="chapter" data-level="1.2" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-workspace"><i class="fa fa-check"></i><b>1.2</b> The workspace</a></li>
<li class="chapter" data-level="1.3" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.3</b> Using R as a calculator</a></li>
<li class="chapter" data-level="1.4" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#sequences"><i class="fa fa-check"></i><b>1.5</b> Sequences</a></li>
<li class="chapter" data-level="1.6" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#displaying-and-changing-parts-of-a-vector-indexing"><i class="fa fa-check"></i><b>1.6</b> Displaying and changing parts of a vector (indexing)</a></li>
<li class="chapter" data-level="1.7" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#lists"><i class="fa fa-check"></i><b>1.7</b> Lists</a></li>
<li class="chapter" data-level="1.8" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data frames</a></li>
<li class="chapter" data-level="1.9" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#working-with-built-in-data-frames"><i class="fa fa-check"></i><b>1.9</b> Working with built-in data frames</a></li>
<li class="chapter" data-level="1.10" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#referencing-parts-of-the-data-frame-indexing"><i class="fa fa-check"></i><b>1.10</b> Referencing parts of the data frame (indexing)</a></li>
<li class="chapter" data-level="1.11" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#summaries"><i class="fa fa-check"></i><b>1.11</b> Summaries</a></li>
<li class="chapter" data-level="1.12" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#generating-new-variables"><i class="fa fa-check"></i><b>1.12</b> Generating new variables</a></li>
<li class="chapter" data-level="1.13" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#turning-a-variable-into-a-factor"><i class="fa fa-check"></i><b>1.13</b> Turning a variable into a factor</a></li>
<li class="chapter" data-level="1.14" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#frequency-tables"><i class="fa fa-check"></i><b>1.14</b> Frequency tables</a></li>
<li class="chapter" data-level="1.15" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#grouping-the-values-of-a-numeric-variable"><i class="fa fa-check"></i><b>1.15</b> Grouping the values of a numeric variable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Reading data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-sources"><i class="fa fa-check"></i><b>2.2</b> Data sources</a></li>
<li class="chapter" data-level="2.3" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-in-text-files"><i class="fa fa-check"></i><b>2.3</b> Data in text files</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#things-that-can-go-wrong"><i class="fa fa-check"></i><b>2.4</b> Things that can go wrong</a></li>
<li class="chapter" data-level="2.5" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#forgetting-the-headers"><i class="fa fa-check"></i><b>2.5</b> Forgetting the headers</a></li>
<li class="chapter" data-level="2.6" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#using-the-wrong-separator"><i class="fa fa-check"></i><b>2.6</b> Using the wrong separator</a></li>
<li class="chapter" data-level="2.7" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#mis-specifying-the-representation-of-missing-values"><i class="fa fa-check"></i><b>2.7</b> Mis-specifying the representation of missing values</a></li>
<li class="chapter" data-level="2.8" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#spreadsheet-data"><i class="fa fa-check"></i><b>2.8</b> Spreadsheet data</a></li>
<li class="chapter" data-level="2.9" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-data-from-the-internet"><i class="fa fa-check"></i><b>2.9</b> Reading data from the Internet</a></li>
<li class="chapter" data-level="2.10" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-from-the-clipboard"><i class="fa fa-check"></i><b>2.10</b> Reading from the clipboard</a></li>
<li class="chapter" data-level="2.11" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#binary-data"><i class="fa fa-check"></i><b>2.11</b> Binary data</a></li>
<li class="chapter" data-level="2.12" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#summary"><i class="fa fa-check"></i><b>2.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#the-births-data"><i class="fa fa-check"></i><b>3.2</b> The <code>births</code> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#tibble-vs-data.frame"><i class="fa fa-check"></i><b>3.3</b> <code>tibble</code> vs <code>data.frame</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#piping-functions"><i class="fa fa-check"></i><b>3.4</b> Piping functions</a></li>
<li class="chapter" data-level="3.5" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#mutate-columns"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> columns</a></li>
<li class="chapter" data-level="3.6" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#select-columns-filter-and-arrange-rows"><i class="fa fa-check"></i><b>3.6</b> <code>select</code> columns, <code>filter</code> and <code>arrange</code> rows</a></li>
<li class="chapter" data-level="3.7" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#group_by-and-summarise-data"><i class="fa fa-check"></i><b>3.7</b> <code>group_by</code> and <code>summarise</code> data</a></li>
<li class="chapter" data-level="3.8" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#multiple-grouping"><i class="fa fa-check"></i><b>3.8</b> Multiple grouping</a></li>
<li class="chapter" data-level="3.9" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bind-and-join-tables"><i class="fa fa-check"></i><b>3.9</b> Bind and join tables</a></li>
<li class="chapter" data-level="3.10" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#data-visualization-with-ggplot2"><i class="fa fa-check"></i><b>3.10</b> Data Visualization with ggplot2</a></li>
<li class="chapter" data-level="3.11" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#pivoting-data-with-tidyr"><i class="fa fa-check"></i><b>3.11</b> pivoting data with tidyr</a></li>
<li class="chapter" data-level="3.12" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#reading-files-with-readr"><i class="fa fa-check"></i><b>3.12</b> reading files with readr</a></li>
<li class="chapter" data-level="3.13" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.13</b> String manipulation with stringr</a></li>
<li class="chapter" data-level="3.14" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#purrr-package-to-apply-functions-to-list"><i class="fa fa-check"></i><b>3.14</b> purrr package to apply functions to list</a></li>
<li class="chapter" data-level="3.15" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bonus-rendering-tables"><i class="fa fa-check"></i><b>3.15</b> Bonus: Rendering tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tabulation.html"><a href="tabulation.html"><i class="fa fa-check"></i><b>4</b> Tabulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tabulation.html"><a href="tabulation.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tabulation.html"><a href="tabulation.html#the-births-data-1"><i class="fa fa-check"></i><b>4.2</b> The births data</a></li>
<li class="chapter" data-level="4.3" data-path="tabulation.html"><a href="tabulation.html#one-way-tables"><i class="fa fa-check"></i><b>4.3</b> One-way tables</a></li>
<li class="chapter" data-level="4.4" data-path="tabulation.html"><a href="tabulation.html#improving-the-presentation-of-tables"><i class="fa fa-check"></i><b>4.4</b> Improving the Presentation of Tables</a></li>
<li class="chapter" data-level="4.5" data-path="tabulation.html"><a href="tabulation.html#two-way-tables"><i class="fa fa-check"></i><b>4.5</b> Two-way Tables</a></li>
<li class="chapter" data-level="4.6" data-path="tabulation.html"><a href="tabulation.html#printing"><i class="fa fa-check"></i><b>4.6</b> Printing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-in-r.html"><a href="graphics-in-r.html"><i class="fa fa-check"></i><b>5</b> Graphics in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#simple-plot-on-the-screen"><i class="fa fa-check"></i><b>5.1</b> Simple plot on the screen</a></li>
<li class="chapter" data-level="5.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#colours"><i class="fa fa-check"></i><b>5.2</b> Colours</a></li>
<li class="chapter" data-level="5.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#adding-to-a-plot"><i class="fa fa-check"></i><b>5.3</b> Adding to a plot</a></li>
<li class="chapter" data-level="5.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#using-indexing-for-plot-elements"><i class="fa fa-check"></i><b>5.4</b> Using indexing for plot elements</a></li>
<li class="chapter" data-level="5.5" data-path="graphics-in-r.html"><a href="graphics-in-r.html#generating-colours"><i class="fa fa-check"></i><b>5.5</b> Generating colours</a></li>
<li class="chapter" data-level="5.6" data-path="graphics-in-r.html"><a href="graphics-in-r.html#saving-your-graphs-for-use-in-other-documents"><i class="fa fa-check"></i><b>5.6</b> Saving your graphs for use in other documents</a></li>
<li class="chapter" data-level="5.7" data-path="graphics-in-r.html"><a href="graphics-in-r.html#interacting-with-a-plot"><i class="fa fa-check"></i><b>5.7</b> Interacting with a plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><i class="fa fa-check"></i><b>6</b> Analysis of hazard rates, their ratios and differences and binary regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#hand-calculations-for-a-single-rate"><i class="fa fa-check"></i><b>6.1</b> Hand calculations for a single rate</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-logarithmic-link"><i class="fa fa-check"></i><b>6.2</b> Poisson model for a single rate with logarithmic link</a></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-identity-link"><i class="fa fa-check"></i><b>6.3</b> Poisson model for a single rate with identity link</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-assuming-the-same-rate-for-several-periods"><i class="fa fa-check"></i><b>6.4</b> Poisson model assuming the same rate for several periods</a></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-ratio"><i class="fa fa-check"></i><b>6.5</b> Analysis of rate ratio</a></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-difference"><i class="fa fa-check"></i><b>6.6</b> Analysis of rate difference</a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#binary-regression"><i class="fa fa-check"></i><b>6.7</b> Binary regression</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#optionalhomework-hand-calculations-and-calculations-using-matrix-tools"><i class="fa fa-check"></i><b>6.8</b> Optional/Homework: Hand calculations and calculations using matrix tools</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html"><i class="fa fa-check"></i><b>7</b> Estimation of effects: simple and more complex</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#response-and-explanatory-variables"><i class="fa fa-check"></i><b>7.1</b> Response and explanatory variables</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#data-set-births"><i class="fa fa-check"></i><b>7.2</b> Data set <code>births</code></a></li>
<li class="chapter" data-level="7.3" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#simple-estimation-with-lm-and-glm"><i class="fa fa-check"></i><b>7.3</b> Simple estimation with <code>lm()</code> and <code>glm()</code></a></li>
<li class="chapter" data-level="7.4" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#stratified-effects-and-interaction-or-effect-measure-modification"><i class="fa fa-check"></i><b>7.4</b> Stratified effects, and interaction or effect-measure modification</a></li>
<li class="chapter" data-level="7.5" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#controlling-or-adjusting-for-the-effect-of-hyp-for-sex"><i class="fa fa-check"></i><b>7.5</b> Controlling or adjusting for the effect of <code>hyp</code> for <code>sex</code></a></li>
<li class="chapter" data-level="7.6" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#numeric-exposure-simple-linear-regression-and-checking-assumptions"><i class="fa fa-check"></i><b>7.6</b> Numeric exposure, simple linear regression and checking assumptions</a></li>
<li class="chapter" data-level="7.7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#penalized-spline-model"><i class="fa fa-check"></i><b>7.7</b> Penalized spline model</a></li>
<li class="chapter" data-level="7.8" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#analysis-of-binary-outcomes"><i class="fa fa-check"></i><b>7.8</b> Analysis of binary outcomes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html"><i class="fa fa-check"></i><b>8</b> Poisson regression &amp; analysis of curved effects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#testis-cancer-data-input-and-housekeeping"><i class="fa fa-check"></i><b>8.1</b> Testis cancer: Data input and housekeeping</a></li>
<li class="chapter" data-level="8.2" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#some-descriptive-analysis"><i class="fa fa-check"></i><b>8.2</b> Some descriptive analysis</a></li>
<li class="chapter" data-level="8.3" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#age-and-period-as-categorical-factors"><i class="fa fa-check"></i><b>8.3</b> Age and period as categorical factors</a></li>
<li class="chapter" data-level="8.4" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#generalized-additive-model-with-penalized-splines"><i class="fa fa-check"></i><b>8.4</b> Generalized additive model with penalized splines</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>9</b> Causal inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="causal-inference.html"><a href="causal-inference.html#proper-adjustment-for-confounding-in-regression-models"><i class="fa fa-check"></i><b>9.1</b> Proper adjustment for confounding in regression models</a></li>
<li class="chapter" data-level="9.2" data-path="causal-inference.html"><a href="causal-inference.html#dag-tools-in-the-package-dagitty"><i class="fa fa-check"></i><b>9.2</b> DAG tools in the package <code>dagitty</code></a></li>
<li class="chapter" data-level="9.3" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variables-estimation-mendelian-randomization"><i class="fa fa-check"></i><b>9.3</b> Instrumental variables estimation: Mendelian randomization</a></li>
<li class="chapter" data-level="9.4" data-path="causal-inference.html"><a href="causal-inference.html#why-are-simulation-exercises-useful-for-causal-inference"><i class="fa fa-check"></i><b>9.4</b> Why are simulation exercises useful for causal inference?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graphics-meccano.html"><a href="graphics-meccano.html"><i class="fa fa-check"></i><b>10</b> Graphics meccano</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graphics-meccano.html"><a href="graphics-meccano.html#base-graphics"><i class="fa fa-check"></i><b>10.1</b> Base graphics</a></li>
<li class="chapter" data-level="10.2" data-path="graphics-meccano.html"><a href="graphics-meccano.html#using-ggplot2"><i class="fa fa-check"></i><b>10.2</b> Using ggplot2</a></li>
<li class="chapter" data-level="10.3" data-path="graphics-meccano.html"><a href="graphics-meccano.html#grid-graphics"><i class="fa fa-check"></i><b>10.3</b> Grid graphics</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html"><i class="fa fa-check"></i><b>11</b> Survival analysis with competing risks: Oral cancer patients</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#description-of-the-data"><i class="fa fa-check"></i><b>11.1</b> Description of the data</a></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#loading-the-packages-and-the-data"><i class="fa fa-check"></i><b>11.2</b> Loading the packages and the data</a></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-kaplanmeier-analyses"><i class="fa fa-check"></i><b>11.3</b> Total mortality: Kaplan–Meier analyses</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-by-stage"><i class="fa fa-check"></i><b>11.4</b> Total mortality by stage</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#event-specific-cumulative-mortality-curves"><i class="fa fa-check"></i><b>11.5</b> Event-specific cumulative mortality curves</a></li>
<li class="chapter" data-level="11.6" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#regression-modelling-of-overall-mortality."><i class="fa fa-check"></i><b>11.6</b> Regression modelling of overall mortality.</a></li>
<li class="chapter" data-level="11.7" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#modelling-event-specific-hazards"><i class="fa fa-check"></i><b>11.7</b> Modelling event-specific hazards</a></li>
<li class="chapter" data-level="11.8" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#lexis-object-with-multi-state-set-up"><i class="fa fa-check"></i><b>11.8</b> Lexis object with multi-state set-up</a></li>
<li class="chapter" data-level="11.9" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#optional-poisson-regression-as-an-alternative-to-cox-model"><i class="fa fa-check"></i><b>11.9</b> Optional: Poisson regression as an alternative to Cox model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html"><i class="fa fa-check"></i><b>12</b> Time-splitting, time-scales and SMR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#age-specific-mortality"><i class="fa fa-check"></i><b>12.1</b> Age-specific mortality</a></li>
<li class="chapter" data-level="12.2" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr"><i class="fa fa-check"></i><b>12.2</b> SMR</a></li>
<li class="chapter" data-level="12.3" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr-modeling"><i class="fa fa-check"></i><b>12.3</b> SMR modeling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><i class="fa fa-check"></i><b>13</b> Nested case-control study and case-cohort study: Risk factors of coronary heart disease</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#reading-the-cohort-data-illustrating-the-study-base-and-risk-sets"><i class="fa fa-check"></i><b>13.1</b> Reading the cohort data, illustrating the study base and risk sets</a></li>
<li class="chapter" data-level="13.2" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#nested-case-control-study"><i class="fa fa-check"></i><b>13.2</b> Nested case-control study</a></li>
<li class="chapter" data-level="13.3" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#case-cohort-study"><i class="fa fa-check"></i><b>13.3</b> Case-cohort study</a></li>
<li class="chapter" data-level="13.4" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#do-these-estimates-resemble-those-obtained-from-nested-case-control-data"><i class="fa fa-check"></i><b>13.4</b> Do these estimates resemble those obtained from nested case-control data?</a></li>
<li class="chapter" data-level="13.5" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#full-cohort-analysis-and-comparisons"><i class="fa fa-check"></i><b>13.5</b> Full cohort analysis and comparisons</a></li>
<li class="chapter" data-level="13.6" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#further-exercises-and-homework"><i class="fa fa-check"></i><b>13.6</b> Further exercises and homework</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html"><i class="fa fa-check"></i><b>14</b> Causal inference 2: Model-based estimation of causal estimands</a>
<ul>
<li class="chapter" data-level="14.1" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#control-of-confounding"><i class="fa fa-check"></i><b>14.1</b> Control of confounding</a></li>
<li class="chapter" data-level="14.2" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#generation-of-target-population-and-true-models"><i class="fa fa-check"></i><b>14.2</b> Generation of target population and true models</a></li>
<li class="chapter" data-level="14.3" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#factual-and-counterfactual-risks---associational-and-causal-contrasts"><i class="fa fa-check"></i><b>14.3</b> Factual and counterfactual risks - associational and causal contrasts</a></li>
<li class="chapter" data-level="14.4" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#outcome-modelling-and-estimation-of-causal-contrasts-by-g-formula"><i class="fa fa-check"></i><b>14.4</b> Outcome modelling and estimation of causal contrasts by g-formula</a></li>
<li class="chapter" data-level="14.5" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#inverse-probability-weighting-ipw-by"><i class="fa fa-check"></i><b>14.5</b> Inverse probability weighting (IPW) by</a></li>
<li class="chapter" data-level="14.6" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#improving-ipw-estimation-and-using-r-package-psweight"><i class="fa fa-check"></i><b>14.6</b> Improving IPW estimation and using R package <code>PSweight</code></a></li>
<li class="chapter" data-level="14.7" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#targeted-maximum-likelihood-estimation-tmle"><i class="fa fa-check"></i><b>14.7</b> Targeted maximum likelihood estimation (TMLE)</a></li>
<li class="chapter" data-level="14.8" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#tmle-with-superlearner"><i class="fa fa-check"></i><b>14.8</b> TMLE with SuperLearner</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html"><i class="fa fa-check"></i><b>15</b> Time-dependent variables and multiple states</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html#the-renal-failure-dataset"><i class="fa fa-check"></i><b>15.1</b> The renal failure dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/SPE-R/SPE" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Practice in Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics-meccano" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Graphics meccano<a href="graphics-meccano.html#graphics-meccano" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The plot below is from a randomized study of the effect of
Tamoxifen treatment on bone mineral metabolism, in a group of
patients who were treated for breast cancer.</p>
<p><img src="graph/bentK.png" /></p>
<p>The data are available in the file <code>alkfos.csv</code> (using comma as
separator, so <code>read.csv</code> will read it).</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb237-1"><a href="graphics-meccano.html#cb237-1" tabindex="-1"></a><span class="co"># change filename as needed</span></span>
<span id="cb237-2"><a href="graphics-meccano.html#cb237-2" tabindex="-1"></a>alkfos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/alkfos.csv&quot;</span>) </span></code></pre></div>
<p>The purpose of this exercise is to show you how to build a similar
graph using base graphics in R. This will take you through a number of
fundamental techniques. The exercise will also walk you through
creating the graph using <code>ggplot2</code>.</p>
<p>To get started, run the code in the housekeeping script
<code>alkfos-house.r</code> . You probably should not study the code in
too much detail at this point. The script create the following
objects in your workspace.</p>
<ul>
<li><code>times</code>, a vector of length 7 giving the observation times</li>
<li><code>means</code>, a <span class="math inline">\(2 \times 7\)</span> matrix giving the mean percentage
change at each time point. Each group has its own row.</li>
<li><code>sems</code>, a <span class="math inline">\(2 \times 7\)</span> matrix giving standard errors of
the means, used to create the error bars.</li>
<li><code>available</code>, a <span class="math inline">\(2 \times 7\)</span> matrixing giving the number
of participants still available</li>
</ul>
<p>Use the <code>objects()</code> to see the objects created function to see
them.</p>
<div id="base-graphics" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Base graphics<a href="graphics-meccano.html#base-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we start building the plot. It is important that you use some form
of script to hold the R code since you will frequently have to modify
and rerun previously entered code.</p>
<ul>
<li>First, plot the means for group 1 (i.e. <code>means[1,]</code>) against
<code>times</code>, using <code>type="b"</code> (look up what this does)</li>
<li>Then <em>add</em> a similar curve for group 2 to the plot using
<code>points</code> or <code>lines</code>. Notice that the new points are below the <span class="math inline">\(y\)</span>
scale of the plot, so you need to revise the initial plot by setting
a suitable <code>ylim</code> value.</li>
<li>Add the error bars using <code>segments</code>. (You can calculate the
endpoints using <code>upper &lt;- means + sems</code> etc.). You may have to
adjust the <code>ylim</code> again.</li>
<li>Add the horizontal line at <span class="math inline">\(y=0\)</span> using <code>abline</code></li>
<li>Use <code>xlab</code> and <code>ylab</code> in the initial <code>plot</code> call to give better axis labels.</li>
<li>We need a nonstandard x axis. Use <code>xaxt="n"</code> to avoid plotting
it at first, then add a custom axis with <code>axis</code></li>
<li>The counts below the x axis can be added using <code>mtext</code> on
lines 5 and 6 below the bottom of the plot, but you need to make
room for the extra lines. Use <code>par(mar=.1 + c(8,4,4,2))</code>
<em>before</em> plotting anything to achieve this.</li>
</ul>
<p>You now have quite a good reconstruction of the original plot. There
are some additional steps you can take to reproduce the published plot
exactly. These are advanced exercises so feel free to come back to
them later.</p>
<ul>
<li>It is not too important here (it was for some other variables
in the study), but the S-PLUS plot has the points for the second
group offset horizontally by a small amount (.25) to prevent
overlap. Redo the plot with this modification.</li>
<li>Further things to fiddle with: Get rid of the bounding box.
Add Control/Tamoxifen labels to the lines of counts. Perhaps use
different plotting symbols. Rotate the y axis values. Modify the
line widths or line styles.</li>
<li>Finally, try plotting to the <code>pdf()</code> device and view
the results using a PDF viewer (<em>e.g.</em> Adobe Acrobat
Reader). You may need to change the <code>pointsize</code> option
and/or the plot dimensions for optimal appearance. You might
also try saving the plot as a metafile and include it in a Word
document.</li>
</ul>
</div>
<div id="using-ggplot2" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Using ggplot2<a href="graphics-meccano.html#using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The housekeeping script <code>alkfos-house.r</code> also creates a data
frame <code>ggdata</code> containing the variables in long format. The
code for generating the data frame is shown below, but you do not need
to repeat it if you have run the script.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb238-1"><a href="graphics-meccano.html#cb238-1" tabindex="-1"></a>ggdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb238-2"><a href="graphics-meccano.html#cb238-2" tabindex="-1"></a>  <span class="at">times =</span> <span class="fu">rep</span>(times, <span class="dv">2</span>),</span>
<span id="cb238-3"><a href="graphics-meccano.html#cb238-3" tabindex="-1"></a>  <span class="at">means =</span> <span class="fu">c</span>(means[<span class="dv">1</span>, ], means[<span class="dv">2</span>, ]),</span>
<span id="cb238-4"><a href="graphics-meccano.html#cb238-4" tabindex="-1"></a>  <span class="at">sds =</span> <span class="fu">c</span>(sds[<span class="dv">1</span>, ], sds[<span class="dv">2</span>, ]),</span>
<span id="cb238-5"><a href="graphics-meccano.html#cb238-5" tabindex="-1"></a>  <span class="at">available =</span> <span class="fu">c</span>(available[<span class="dv">1</span>, ], available[<span class="dv">2</span>, ]),</span>
<span id="cb238-6"><a href="graphics-meccano.html#cb238-6" tabindex="-1"></a>  <span class="at">treat =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;placebo&quot;</span>, <span class="st">&quot;tamoxifen&quot;</span>), <span class="at">each =</span> <span class="dv">7</span>)</span>
<span id="cb238-7"><a href="graphics-meccano.html#cb238-7" tabindex="-1"></a>)</span>
<span id="cb238-8"><a href="graphics-meccano.html#cb238-8" tabindex="-1"></a>ggdata <span class="ot">&lt;-</span> <span class="fu">transform</span>(ggdata, <span class="at">sems =</span> sds <span class="sc">/</span> <span class="fu">sqrt</span>(available))</span></code></pre></div>
<p>To create a first approximation to the plot in <code>ggplot2</code> we
use the <code>qplot</code> function (short for <em>quick plot</em>). First you
must install the <code>ggplot2</code> package from CRAN and then load it:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb239-1"><a href="graphics-meccano.html#cb239-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb239-2"><a href="graphics-meccano.html#cb239-2" tabindex="-1"></a><span class="fu">qplot</span>(</span>
<span id="cb239-3"><a href="graphics-meccano.html#cb239-3" tabindex="-1"></a>  <span class="at">x =</span> times, </span>
<span id="cb239-4"><a href="graphics-meccano.html#cb239-4" tabindex="-1"></a>  <span class="at">y =</span> means, </span>
<span id="cb239-5"><a href="graphics-meccano.html#cb239-5" tabindex="-1"></a>  <span class="at">group =</span> treat, </span>
<span id="cb239-6"><a href="graphics-meccano.html#cb239-6" tabindex="-1"></a>  <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;line&quot;</span>), </span>
<span id="cb239-7"><a href="graphics-meccano.html#cb239-7" tabindex="-1"></a>  <span class="at">data =</span> ggdata</span>
<span id="cb239-8"><a href="graphics-meccano.html#cb239-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: `qplot()` was deprecated in ggplot2 3.4.0.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p>The first arguments to <code>qplot</code> are called <em>aesthetics</em> in the
grammar of graphics. Here we want to plot <code>y=means</code> by
<code>x=times</code> grouped by <code>group=treat</code>. The aesthetics
are used by the <em>geometries</em>, which are specified with the
<code>geom</code> argument. Here we want to plot both points and
lines. The <code>data</code> argument tells <code>qplot</code> to get the
aesthetics from the data frame <code>ggdata</code>.</p>
<p>To add the error bars, we add a new geometry <em>linerange</em> which uses
the aesthetics <code>ymin</code> and <code>ymax</code></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb241-1"><a href="graphics-meccano.html#cb241-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">qplot</span>(</span>
<span id="cb241-2"><a href="graphics-meccano.html#cb241-2" tabindex="-1"></a>  <span class="at">x =</span> times, <span class="at">y =</span> means, <span class="at">group =</span> treat,</span>
<span id="cb241-3"><a href="graphics-meccano.html#cb241-3" tabindex="-1"></a>  <span class="at">ymin =</span> means <span class="sc">-</span> sems, <span class="at">ymax =</span> means <span class="sc">+</span> sems,</span>
<span id="cb241-4"><a href="graphics-meccano.html#cb241-4" tabindex="-1"></a>  <span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;line&quot;</span>, <span class="st">&quot;linerange&quot;</span>),</span>
<span id="cb241-5"><a href="graphics-meccano.html#cb241-5" tabindex="-1"></a>  <span class="at">data =</span> ggdata</span>
<span id="cb241-6"><a href="graphics-meccano.html#cb241-6" tabindex="-1"></a>)</span>
<span id="cb241-7"><a href="graphics-meccano.html#cb241-7" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p>In this case we are saving the output of <code>qplot</code> to an R
object <code>p</code>. This means the plot will not appear automatically
when we call <code>qplot</code>. Instead, we must explicitly print it.</p>
<p>Note how the y axes are automatically adjusted to include the error
bars. This is because they are included in the call to <code>qplot</code>
and not added later (as was the case with base graphics).</p>
<p>It remains to give informative axis labels and put the right tick
marks on the x-axis. This is done by adding scales to the plot</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb242-1"><a href="graphics-meccano.html#cb242-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb242-2"><a href="graphics-meccano.html#cb242-2" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb242-3"><a href="graphics-meccano.html#cb242-3" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Months after randomization&quot;</span>,</span>
<span id="cb242-4"><a href="graphics-meccano.html#cb242-4" tabindex="-1"></a>    <span class="at">breaks =</span> ggdata<span class="sc">$</span>times</span>
<span id="cb242-5"><a href="graphics-meccano.html#cb242-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb242-6"><a href="graphics-meccano.html#cb242-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;% change in alkaline phosphatase&quot;</span>)</span>
<span id="cb242-7"><a href="graphics-meccano.html#cb242-7" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p>We can also change the look and feel of the plot by adding a theme
(in this case the black and white theme).</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb243-1"><a href="graphics-meccano.html#cb243-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>As an alternative to <code>qplot</code>, we can use the <code>ggplot</code>
function to define the data and the common aesthetics, then add the
geometries with separate function calls. All the grobs (<em>graphical objects</em>)
created by these function calls are combined with the
<code>+</code> operator:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb244-1"><a href="graphics-meccano.html#cb244-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb244-2"><a href="graphics-meccano.html#cb244-2" tabindex="-1"></a>  <span class="at">data =</span> ggdata,</span>
<span id="cb244-3"><a href="graphics-meccano.html#cb244-3" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb244-4"><a href="graphics-meccano.html#cb244-4" tabindex="-1"></a>    <span class="at">x =</span> times, </span>
<span id="cb244-5"><a href="graphics-meccano.html#cb244-5" tabindex="-1"></a>    <span class="at">y =</span> means, </span>
<span id="cb244-6"><a href="graphics-meccano.html#cb244-6" tabindex="-1"></a>    <span class="at">ymin =</span> means <span class="sc">-</span> sems, </span>
<span id="cb244-7"><a href="graphics-meccano.html#cb244-7" tabindex="-1"></a>    <span class="at">ymax =</span> means <span class="sc">+</span> sems,</span>
<span id="cb244-8"><a href="graphics-meccano.html#cb244-8" tabindex="-1"></a>    <span class="at">group =</span> treat</span>
<span id="cb244-9"><a href="graphics-meccano.html#cb244-9" tabindex="-1"></a>  )</span>
<span id="cb244-10"><a href="graphics-meccano.html#cb244-10" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb244-11"><a href="graphics-meccano.html#cb244-11" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb244-12"><a href="graphics-meccano.html#cb244-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb244-13"><a href="graphics-meccano.html#cb244-13" tabindex="-1"></a>  <span class="fu">geom_linerange</span>() <span class="sc">+</span></span>
<span id="cb244-14"><a href="graphics-meccano.html#cb244-14" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb244-15"><a href="graphics-meccano.html#cb244-15" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> ggdata<span class="sc">$</span>times) <span class="sc">+</span></span>
<span id="cb244-16"><a href="graphics-meccano.html#cb244-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">35</span>, <span class="dv">25</span>, <span class="dv">5</span>))</span>
<span id="cb244-17"><a href="graphics-meccano.html#cb244-17" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p>This call adds another geometry <em>hline</em> which uses the aesthetic
<code>yintercept</code> to add a horizontal line at 0 on the y-axis. Note
that this alternate syntax allows each geometry to have its own
aesthetics: here we draw the horizontal line in darkgrey instead of
the default black.</p>
</div>
<div id="grid-graphics" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Grid graphics<a href="graphics-meccano.html#grid-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As a final, advanced topic, this subsection shows how viewports from
the <code>grid</code> package may be used to display the plot and the
table in the same graph. First we create a text table:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb245-1"><a href="graphics-meccano.html#cb245-1" tabindex="-1"></a>tab <span class="ot">&lt;-</span> </span>
<span id="cb245-2"><a href="graphics-meccano.html#cb245-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb245-3"><a href="graphics-meccano.html#cb245-3" tabindex="-1"></a>    <span class="at">data =</span> ggdata, </span>
<span id="cb245-4"><a href="graphics-meccano.html#cb245-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> times, <span class="at">y =</span> treat, <span class="at">label =</span> available)</span>
<span id="cb245-5"><a href="graphics-meccano.html#cb245-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb245-6"><a href="graphics-meccano.html#cb245-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb245-7"><a href="graphics-meccano.html#cb245-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb245-8"><a href="graphics-meccano.html#cb245-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb245-9"><a href="graphics-meccano.html#cb245-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>)</span>
<span id="cb245-10"><a href="graphics-meccano.html#cb245-10" tabindex="-1"></a>tab</span></code></pre></div>
<p>Then we create a layout that will contain the graph above the
table. Most of the space is taken by the graph. The
<code>grid.show.layout</code> allows you to preview the layout.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb246-1"><a href="graphics-meccano.html#cb246-1" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb246-2"><a href="graphics-meccano.html#cb246-2" tabindex="-1"></a>Layout <span class="ot">&lt;-</span> <span class="fu">grid.layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">unit</span>(</span>
<span id="cb246-3"><a href="graphics-meccano.html#cb246-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.25</span>),</span>
<span id="cb246-4"><a href="graphics-meccano.html#cb246-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;null&quot;</span>, <span class="st">&quot;null&quot;</span>)</span>
<span id="cb246-5"><a href="graphics-meccano.html#cb246-5" tabindex="-1"></a>))</span>
<span id="cb246-6"><a href="graphics-meccano.html#cb246-6" tabindex="-1"></a><span class="fu">grid.show.layout</span>(Layout)</span></code></pre></div>
<p>The units are relative (<em>null</em>) units. You can specify exact sizes
in centimetres, inches, or lines if you prefer.</p>
<p>We then print the graph and the table in the appropriate viewports</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb247-1"><a href="graphics-meccano.html#cb247-1" tabindex="-1"></a><span class="fu">grid.newpage</span>() <span class="co"># Clear the page</span></span>
<span id="cb247-2"><a href="graphics-meccano.html#cb247-2" tabindex="-1"></a><span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> Layout))</span>
<span id="cb247-3"><a href="graphics-meccano.html#cb247-3" tabindex="-1"></a><span class="fu">print</span>(p, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">1</span>, <span class="at">layout.pos.col =</span> <span class="dv">1</span>))</span>
<span id="cb247-4"><a href="graphics-meccano.html#cb247-4" tabindex="-1"></a><span class="fu">print</span>(tab, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">2</span>, <span class="at">layout.pos.col =</span> <span class="dv">1</span>))</span></code></pre></div>
<p>Notice that the left margins do not match. One way to get the margins to match is to use the <code>plot_grid</code>
function from the<code>cowplot</code> package.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb248-1"><a href="graphics-meccano.html#cb248-1" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lubridate&#39;:
## 
##     stamp</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb251-1"><a href="graphics-meccano.html#cb251-1" tabindex="-1"></a><span class="fu">plot_grid</span>(</span>
<span id="cb251-2"><a href="graphics-meccano.html#cb251-2" tabindex="-1"></a>  p, </span>
<span id="cb251-3"><a href="graphics-meccano.html#cb251-3" tabindex="-1"></a>  tab, </span>
<span id="cb251-4"><a href="graphics-meccano.html#cb251-4" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">&quot;v&quot;</span>, </span>
<span id="cb251-5"><a href="graphics-meccano.html#cb251-5" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb251-6"><a href="graphics-meccano.html#cb251-6" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb251-7"><a href="graphics-meccano.html#cb251-7" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb251-8"><a href="graphics-meccano.html#cb251-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>cowplot</code> package has a theme that is useful for publications. It is a black and white theme with no grid:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb252-1"><a href="graphics-meccano.html#cb252-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_cowplot</span>())</span>
<span id="cb252-2"><a href="graphics-meccano.html#cb252-2" tabindex="-1"></a><span class="fu">plot_grid</span>(</span>
<span id="cb252-3"><a href="graphics-meccano.html#cb252-3" tabindex="-1"></a>  p, </span>
<span id="cb252-4"><a href="graphics-meccano.html#cb252-4" tabindex="-1"></a>  tab, </span>
<span id="cb252-5"><a href="graphics-meccano.html#cb252-5" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">&quot;v&quot;</span>, </span>
<span id="cb252-6"><a href="graphics-meccano.html#cb252-6" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb252-7"><a href="graphics-meccano.html#cb252-7" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb252-8"><a href="graphics-meccano.html#cb252-8" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb252-9"><a href="graphics-meccano.html#cb252-9" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>theme_set</code> function changes the default
<code>ggplot2</code> theme so that all subsequent displays will use the given theme.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="causal-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SPE-R/SPE/edit/master/pracs-book/graphics-e.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPE-R-2024-practicals.pdf", "SPE-R-2024-practicals.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
