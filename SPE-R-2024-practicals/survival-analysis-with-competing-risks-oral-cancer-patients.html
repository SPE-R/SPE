<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Survival analysis with competing risks: Oral cancer patients | Statistical Practice in Epidemiology with R</title>
  <meta name="description" content="This is the SPE-R 2024 exercises book" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Survival analysis with competing risks: Oral cancer patients | Statistical Practice in Epidemiology with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the SPE-R 2024 exercises book" />
  <meta name="github-repo" content="spe-r/spe" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Survival analysis with competing risks: Oral cancer patients | Statistical Practice in Epidemiology with R" />
  
  <meta name="twitter:description" content="This is the SPE-R 2024 exercises book" />
  

<meta name="author" content="Krista Fischer" />
<meta name="author" content="Martyn Plummer" />
<meta name="author" content="Janne Pitkäniemi" />
<meta name="author" content="Bendix Carstensen" />
<meta name="author" content="Damien Georges" />
<meta name="author" content="Esa Läärä" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="graphics-with-ggplot2.html"/>
<link rel="next" href="time-splitting-time-scales-and-smr.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPE-R practicals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html"><i class="fa fa-check"></i><b>1</b> Practice with basic R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-working-directory"><i class="fa fa-check"></i><b>1.1</b> The working directory</a></li>
<li class="chapter" data-level="1.2" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-workspace"><i class="fa fa-check"></i><b>1.2</b> The workspace</a></li>
<li class="chapter" data-level="1.3" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.3</b> Using R as a calculator</a></li>
<li class="chapter" data-level="1.4" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#sequences"><i class="fa fa-check"></i><b>1.5</b> Sequences</a></li>
<li class="chapter" data-level="1.6" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#displaying-and-changing-parts-of-a-vector-indexing"><i class="fa fa-check"></i><b>1.6</b> Displaying and changing parts of a vector (indexing)</a></li>
<li class="chapter" data-level="1.7" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#lists"><i class="fa fa-check"></i><b>1.7</b> Lists</a></li>
<li class="chapter" data-level="1.8" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data frames</a></li>
<li class="chapter" data-level="1.9" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#working-with-built-in-data-frames"><i class="fa fa-check"></i><b>1.9</b> Working with built-in data frames</a></li>
<li class="chapter" data-level="1.10" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#referencing-parts-of-the-data-frame-indexing"><i class="fa fa-check"></i><b>1.10</b> Referencing parts of the data frame (indexing)</a></li>
<li class="chapter" data-level="1.11" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#summaries"><i class="fa fa-check"></i><b>1.11</b> Summaries</a></li>
<li class="chapter" data-level="1.12" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#generating-new-variables"><i class="fa fa-check"></i><b>1.12</b> Generating new variables</a></li>
<li class="chapter" data-level="1.13" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#turning-a-variable-into-a-factor"><i class="fa fa-check"></i><b>1.13</b> Turning a variable into a factor</a></li>
<li class="chapter" data-level="1.14" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#frequency-tables"><i class="fa fa-check"></i><b>1.14</b> Frequency tables</a></li>
<li class="chapter" data-level="1.15" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#grouping-the-values-of-a-numeric-variable"><i class="fa fa-check"></i><b>1.15</b> Grouping the values of a numeric variable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Reading data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-sources"><i class="fa fa-check"></i><b>2.2</b> Data sources</a></li>
<li class="chapter" data-level="2.3" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-in-text-files"><i class="fa fa-check"></i><b>2.3</b> Data in text files</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#things-that-can-go-wrong"><i class="fa fa-check"></i><b>2.4</b> Things that can go wrong</a></li>
<li class="chapter" data-level="2.5" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#forgetting-the-headers"><i class="fa fa-check"></i><b>2.5</b> Forgetting the headers</a></li>
<li class="chapter" data-level="2.6" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#using-the-wrong-separator"><i class="fa fa-check"></i><b>2.6</b> Using the wrong separator</a></li>
<li class="chapter" data-level="2.7" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#mis-specifying-the-representation-of-missing-values"><i class="fa fa-check"></i><b>2.7</b> Mis-specifying the representation of missing values</a></li>
<li class="chapter" data-level="2.8" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#spreadsheet-data"><i class="fa fa-check"></i><b>2.8</b> Spreadsheet data</a></li>
<li class="chapter" data-level="2.9" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-data-from-the-internet"><i class="fa fa-check"></i><b>2.9</b> Reading data from the Internet</a></li>
<li class="chapter" data-level="2.10" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-from-the-clipboard"><i class="fa fa-check"></i><b>2.10</b> Reading from the clipboard</a></li>
<li class="chapter" data-level="2.11" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#binary-data"><i class="fa fa-check"></i><b>2.11</b> Binary data</a></li>
<li class="chapter" data-level="2.12" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#summary"><i class="fa fa-check"></i><b>2.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#the-births-data"><i class="fa fa-check"></i><b>3.2</b> The <code>births</code> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#tibble-vs-data.frame"><i class="fa fa-check"></i><b>3.3</b> <code>tibble</code> vs <code>data.frame</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#piping-functions"><i class="fa fa-check"></i><b>3.4</b> Piping functions</a></li>
<li class="chapter" data-level="3.5" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#mutate-columns"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> columns</a></li>
<li class="chapter" data-level="3.6" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#select-columns-filter-and-arrange-rows"><i class="fa fa-check"></i><b>3.6</b> <code>select</code> columns, <code>filter</code> and <code>arrange</code> rows</a></li>
<li class="chapter" data-level="3.7" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#group_by-and-summarise-data"><i class="fa fa-check"></i><b>3.7</b> <code>group_by</code> and <code>summarise</code> data</a></li>
<li class="chapter" data-level="3.8" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#multiple-grouping"><i class="fa fa-check"></i><b>3.8</b> Multiple grouping</a></li>
<li class="chapter" data-level="3.9" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bind-and-join-tables"><i class="fa fa-check"></i><b>3.9</b> Bind and join tables</a></li>
<li class="chapter" data-level="3.10" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#data-visualization-with-ggplot2"><i class="fa fa-check"></i><b>3.10</b> Data Visualization with ggplot2</a></li>
<li class="chapter" data-level="3.11" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#pivoting-data-with-tidyr"><i class="fa fa-check"></i><b>3.11</b> pivoting data with tidyr</a></li>
<li class="chapter" data-level="3.12" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#reading-files-with-readr"><i class="fa fa-check"></i><b>3.12</b> reading files with readr</a></li>
<li class="chapter" data-level="3.13" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.13</b> String manipulation with stringr</a></li>
<li class="chapter" data-level="3.14" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#purrr-package-to-apply-functions-to-list"><i class="fa fa-check"></i><b>3.14</b> purrr package to apply functions to list</a></li>
<li class="chapter" data-level="3.15" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bonus-rendering-tables"><i class="fa fa-check"></i><b>3.15</b> Bonus: Rendering tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tabulation.html"><a href="tabulation.html"><i class="fa fa-check"></i><b>4</b> Tabulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tabulation.html"><a href="tabulation.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tabulation.html"><a href="tabulation.html#the-births-data-1"><i class="fa fa-check"></i><b>4.2</b> The births data</a></li>
<li class="chapter" data-level="4.3" data-path="tabulation.html"><a href="tabulation.html#one-way-tables"><i class="fa fa-check"></i><b>4.3</b> One-way tables</a></li>
<li class="chapter" data-level="4.4" data-path="tabulation.html"><a href="tabulation.html#improving-the-presentation-of-tables"><i class="fa fa-check"></i><b>4.4</b> Improving the Presentation of Tables</a></li>
<li class="chapter" data-level="4.5" data-path="tabulation.html"><a href="tabulation.html#two-way-tables"><i class="fa fa-check"></i><b>4.5</b> Two-way Tables</a></li>
<li class="chapter" data-level="4.6" data-path="tabulation.html"><a href="tabulation.html#printing"><i class="fa fa-check"></i><b>4.6</b> Printing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-in-r.html"><a href="graphics-in-r.html"><i class="fa fa-check"></i><b>5</b> Graphics in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#simple-plot-on-the-screen"><i class="fa fa-check"></i><b>5.1</b> Simple plot on the screen</a></li>
<li class="chapter" data-level="5.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#colours"><i class="fa fa-check"></i><b>5.2</b> Colours</a></li>
<li class="chapter" data-level="5.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#adding-to-a-plot"><i class="fa fa-check"></i><b>5.3</b> Adding to a plot</a></li>
<li class="chapter" data-level="5.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#using-indexing-for-plot-elements"><i class="fa fa-check"></i><b>5.4</b> Using indexing for plot elements</a></li>
<li class="chapter" data-level="5.5" data-path="graphics-in-r.html"><a href="graphics-in-r.html#generating-colours"><i class="fa fa-check"></i><b>5.5</b> Generating colours</a></li>
<li class="chapter" data-level="5.6" data-path="graphics-in-r.html"><a href="graphics-in-r.html#saving-your-graphs-for-use-in-other-documents"><i class="fa fa-check"></i><b>5.6</b> Saving your graphs for use in other documents</a></li>
<li class="chapter" data-level="5.7" data-path="graphics-in-r.html"><a href="graphics-in-r.html#interacting-with-a-plot"><i class="fa fa-check"></i><b>5.7</b> Interacting with a plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><i class="fa fa-check"></i><b>6</b> Analysis of hazard rates, their ratios and differences and binary regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#hand-calculations-for-a-single-rate"><i class="fa fa-check"></i><b>6.1</b> Hand calculations for a single rate</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-logarithmic-link"><i class="fa fa-check"></i><b>6.2</b> Poisson model for a single rate with logarithmic link</a></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-identity-link"><i class="fa fa-check"></i><b>6.3</b> Poisson model for a single rate with identity link</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-assuming-the-same-rate-for-several-periods"><i class="fa fa-check"></i><b>6.4</b> Poisson model assuming the same rate for several periods</a></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-ratio"><i class="fa fa-check"></i><b>6.5</b> Analysis of rate ratio</a></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-difference"><i class="fa fa-check"></i><b>6.6</b> Analysis of rate difference</a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#binary-regression"><i class="fa fa-check"></i><b>6.7</b> Binary regression</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#optionalhomework-hand-calculations-and-calculations-using-matrix-tools"><i class="fa fa-check"></i><b>6.8</b> Optional/Homework: Hand calculations and calculations using matrix tools</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html"><i class="fa fa-check"></i><b>7</b> Estimation of effects: simple and more complex</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#response-and-explanatory-variables"><i class="fa fa-check"></i><b>7.1</b> Response and explanatory variables</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#data-set-births"><i class="fa fa-check"></i><b>7.2</b> Data set <code>births</code></a></li>
<li class="chapter" data-level="7.3" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#simple-estimation-with-lm-and-glm"><i class="fa fa-check"></i><b>7.3</b> Simple estimation with <code>lm()</code> and <code>glm()</code></a></li>
<li class="chapter" data-level="7.4" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#stratified-effects-and-interaction-or-effect-measure-modification"><i class="fa fa-check"></i><b>7.4</b> Stratified effects, and interaction or effect-measure modification</a></li>
<li class="chapter" data-level="7.5" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#controlling-or-adjusting-for-the-effect-of-hyp-for-sex"><i class="fa fa-check"></i><b>7.5</b> Controlling or adjusting for the effect of <code>hyp</code> for <code>sex</code></a></li>
<li class="chapter" data-level="7.6" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#numeric-exposure-simple-linear-regression-and-checking-assumptions"><i class="fa fa-check"></i><b>7.6</b> Numeric exposure, simple linear regression and checking assumptions</a></li>
<li class="chapter" data-level="7.7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#penalized-spline-model"><i class="fa fa-check"></i><b>7.7</b> Penalized spline model</a></li>
<li class="chapter" data-level="7.8" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#analysis-of-binary-outcomes"><i class="fa fa-check"></i><b>7.8</b> Analysis of binary outcomes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html"><i class="fa fa-check"></i><b>8</b> Poisson regression &amp; analysis of curved effects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#testis-cancer-data-input-and-housekeeping"><i class="fa fa-check"></i><b>8.1</b> Testis cancer: Data input and housekeeping</a></li>
<li class="chapter" data-level="8.2" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#some-descriptive-analysis"><i class="fa fa-check"></i><b>8.2</b> Some descriptive analysis</a></li>
<li class="chapter" data-level="8.3" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#age-and-period-as-categorical-factors"><i class="fa fa-check"></i><b>8.3</b> Age and period as categorical factors</a></li>
<li class="chapter" data-level="8.4" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#generalized-additive-model-with-penalized-splines"><i class="fa fa-check"></i><b>8.4</b> Generalized additive model with penalized splines</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>9</b> Causal inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="causal-inference.html"><a href="causal-inference.html#proper-adjustment-for-confounding-in-regression-models"><i class="fa fa-check"></i><b>9.1</b> Proper adjustment for confounding in regression models</a></li>
<li class="chapter" data-level="9.2" data-path="causal-inference.html"><a href="causal-inference.html#dag-tools-in-the-package-dagitty"><i class="fa fa-check"></i><b>9.2</b> DAG tools in the package <code>dagitty</code></a></li>
<li class="chapter" data-level="9.3" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variables-estimation-mendelian-randomization"><i class="fa fa-check"></i><b>9.3</b> Instrumental variables estimation: Mendelian randomization</a></li>
<li class="chapter" data-level="9.4" data-path="causal-inference.html"><a href="causal-inference.html#why-are-simulation-exercises-useful-for-causal-inference"><i class="fa fa-check"></i><b>9.4</b> Why are simulation exercises useful for causal inference?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>10</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#data"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#building-the-plot"><i class="fa fa-check"></i><b>10.2</b> Building the plot</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#the-ggplot2-package"><i class="fa fa-check"></i><b>10.2.1</b> The ggplot2 package</a></li>
<li class="chapter" data-level="10.2.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#geometries"><i class="fa fa-check"></i><b>10.2.2</b> Geometries</a></li>
<li class="chapter" data-level="10.2.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>10.2.3</b> Scales</a></li>
<li class="chapter" data-level="10.2.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>10.2.4</b> Themes</a></li>
<li class="chapter" data-level="10.2.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#putting-everything-together"><i class="fa fa-check"></i><b>10.2.5</b> Putting everything together</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#self-study"><i class="fa fa-check"></i><b>10.3</b> Self study</a></li>
<li class="chapter" data-level="10.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-the-table-advanced-topic"><i class="fa fa-check"></i><b>10.4</b> Adding the table (advanced topic)</a></li>
<li class="chapter" data-level="10.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#references"><i class="fa fa-check"></i><b>10.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html"><i class="fa fa-check"></i><b>11</b> Survival analysis with competing risks: Oral cancer patients</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#description-of-the-data"><i class="fa fa-check"></i><b>11.1</b> Description of the data</a></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#loading-the-packages-and-the-data"><i class="fa fa-check"></i><b>11.2</b> Loading the packages and the data</a></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-kaplanmeier-analyses"><i class="fa fa-check"></i><b>11.3</b> Total mortality: Kaplan–Meier analyses</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-by-stage"><i class="fa fa-check"></i><b>11.4</b> Total mortality by stage</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#event-specific-cumulative-mortality-curves"><i class="fa fa-check"></i><b>11.5</b> Event-specific cumulative mortality curves</a></li>
<li class="chapter" data-level="11.6" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#regression-modelling-of-overall-mortality."><i class="fa fa-check"></i><b>11.6</b> Regression modelling of overall mortality.</a></li>
<li class="chapter" data-level="11.7" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#modelling-event-specific-hazards"><i class="fa fa-check"></i><b>11.7</b> Modelling event-specific hazards</a></li>
<li class="chapter" data-level="11.8" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#lexis-object-with-multi-state-set-up"><i class="fa fa-check"></i><b>11.8</b> Lexis object with multi-state set-up</a></li>
<li class="chapter" data-level="11.9" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#optional-poisson-regression-as-an-alternative-to-cox-model"><i class="fa fa-check"></i><b>11.9</b> Optional: Poisson regression as an alternative to Cox model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html"><i class="fa fa-check"></i><b>12</b> Time-splitting, time-scales and SMR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#age-specific-mortality"><i class="fa fa-check"></i><b>12.1</b> Age-specific mortality</a></li>
<li class="chapter" data-level="12.2" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr"><i class="fa fa-check"></i><b>12.2</b> SMR</a></li>
<li class="chapter" data-level="12.3" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr-modeling"><i class="fa fa-check"></i><b>12.3</b> SMR modeling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><i class="fa fa-check"></i><b>13</b> Nested case-control study and case-cohort study: Risk factors of coronary heart disease</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#reading-the-cohort-data-illustrating-the-study-base-and-risk-sets"><i class="fa fa-check"></i><b>13.1</b> Reading the cohort data, illustrating the study base and risk sets</a></li>
<li class="chapter" data-level="13.2" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#nested-case-control-study"><i class="fa fa-check"></i><b>13.2</b> Nested case-control study</a></li>
<li class="chapter" data-level="13.3" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#case-cohort-study"><i class="fa fa-check"></i><b>13.3</b> Case-cohort study</a></li>
<li class="chapter" data-level="13.4" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#do-these-estimates-resemble-those-obtained-from-nested-case-control-data"><i class="fa fa-check"></i><b>13.4</b> Do these estimates resemble those obtained from nested case-control data?</a></li>
<li class="chapter" data-level="13.5" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#full-cohort-analysis-and-comparisons"><i class="fa fa-check"></i><b>13.5</b> Full cohort analysis and comparisons</a></li>
<li class="chapter" data-level="13.6" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#further-exercises-and-homework"><i class="fa fa-check"></i><b>13.6</b> Further exercises and homework</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html"><i class="fa fa-check"></i><b>14</b> Causal inference 2: Model-based estimation of causal estimands</a>
<ul>
<li class="chapter" data-level="14.1" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#control-of-confounding"><i class="fa fa-check"></i><b>14.1</b> Control of confounding</a></li>
<li class="chapter" data-level="14.2" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#generation-of-target-population-and-true-models"><i class="fa fa-check"></i><b>14.2</b> Generation of target population and true models</a></li>
<li class="chapter" data-level="14.3" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#factual-and-counterfactual-risks---associational-and-causal-contrasts"><i class="fa fa-check"></i><b>14.3</b> Factual and counterfactual risks - associational and causal contrasts</a></li>
<li class="chapter" data-level="14.4" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#outcome-modelling-and-estimation-of-causal-contrasts-by-g-formula"><i class="fa fa-check"></i><b>14.4</b> Outcome modelling and estimation of causal contrasts by g-formula</a></li>
<li class="chapter" data-level="14.5" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#inverse-probability-weighting-ipw-by-propensity-scores"><i class="fa fa-check"></i><b>14.5</b> Inverse probability weighting (IPW) by propensity scores</a></li>
<li class="chapter" data-level="14.6" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#improving-ipw-estimation-and-using-r-package-psweight"><i class="fa fa-check"></i><b>14.6</b> Improving IPW estimation and using R package <code>PSweight</code></a></li>
<li class="chapter" data-level="14.7" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#effect-of-exposure-among-those-exposed"><i class="fa fa-check"></i><b>14.7</b> Effect of exposure among those exposed</a></li>
<li class="chapter" data-level="14.8" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#augmented-ipw"><i class="fa fa-check"></i><b>14.8</b> Augmented IPW</a></li>
<li class="chapter" data-level="14.9" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#targeted-maximum-likelihood-estimation-tmle"><i class="fa fa-check"></i><b>14.9</b> Targeted maximum likelihood estimation (TMLE)</a></li>
<li class="chapter" data-level="14.10" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#tmle-with-superlearner"><i class="fa fa-check"></i><b>14.10</b> TMLE with SuperLearner</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html"><i class="fa fa-check"></i><b>15</b> Time-dependent variables and multiple states</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html#the-renal-failure-dataset"><i class="fa fa-check"></i><b>15.1</b> The renal failure dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/SPE-R/SPE" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Practice in Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="survival-analysis-with-competing-risks-oral-cancer-patients" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Survival analysis with competing risks: Oral cancer patients<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#survival-analysis-with-competing-risks-oral-cancer-patients" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="description-of-the-data" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Description of the data<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#description-of-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>File <code>oralca2.txt</code>, that you may
access from a url address to be given in the practical, contains data from 338
patients having an oral squamous cell carcinoma diagnosed and treated
in one tertiary level oncological clinic in Finland since 1985, followed-up
for mortality until 31 December 2008.</p>
<p>The dataset contains the following variables:</p>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>sex</code></td>
<td align="left">sex, a factor with categories; <code>1 = "Female", 2 = "Male"</code></td>
</tr>
<tr class="even">
<td align="left"><code>age</code></td>
<td align="left">age (years) at the date of diagnosing the cancer</td>
</tr>
<tr class="odd">
<td align="left"><code>stage</code></td>
<td align="left">TNM stage of the tumour (factor): <code>1 = "I", ..., 4 = "IV", 5 = "unkn"</code></td>
</tr>
<tr class="even">
<td align="left"><code>time</code></td>
<td align="left">follow-up time (in years) since diagnosis until death or censoring</td>
</tr>
<tr class="odd">
<td align="left"><code>event</code></td>
<td align="left">event ending the follow-up (numeric): <code>0 = censoring alive, 1 = death from oral cancer, 2 = death from other causes.</code></td>
</tr>
</tbody>
</table>
</div>
<div id="loading-the-packages-and-the-data" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Loading the packages and the data<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#loading-the-packages-and-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Load the R packages <code>Epi</code>, and <code>survival</code> needed in this exercise.</li>
</ul>
<div class="sourceCode" id="cb245"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb245-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb245-1" tabindex="-1"></a><span class="fu">library</span>(Epi)</span>
<span id="cb245-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb245-2" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
<ul>
<li>Read the datafile <code>oralca2.txt</code> from
a website, whose precise address will be given in the practical,
into an R data frame named <code>orca</code>.
Look at the head, structure and the summary of the data frame.
Using function <code>table()</code> count the numbers of censorings
as well as deaths from oral cancer and other causes, respectively,
from the <code>event</code> variable.</li>
</ul>
<div class="sourceCode" id="cb246"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb246-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb246-1" tabindex="-1"></a>orca <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;pracs/data/oralca2.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb246-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb246-2" tabindex="-1"></a><span class="fu">head</span>(orca)</span>
<span id="cb246-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb246-3" tabindex="-1"></a><span class="fu">str</span>(orca)</span>
<span id="cb246-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb246-4" tabindex="-1"></a><span class="fu">summary</span>(orca)</span></code></pre></div>
</div>
<div id="total-mortality-kaplanmeier-analyses" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Total mortality: Kaplan–Meier analyses<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-kaplanmeier-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>We start our analysis of total mortality pooling the two causes of death into
a single outcome.
First, construct a <em>survival object</em> <code>suob</code> from
the event variable and the follow-up time using function <code>Surv()</code>.
Look at the structure and summary of <code>suob</code> .</li>
</ul>
<div class="sourceCode" id="cb247"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb247-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb247-1" tabindex="-1"></a>suob <span class="ot">&lt;-</span> <span class="fu">Surv</span>(orca<span class="sc">$</span>time, <span class="dv">1</span> <span class="sc">*</span> (orca<span class="sc">$</span>event <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb247-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb247-2" tabindex="-1"></a><span class="fu">str</span>(suob)</span>
<span id="cb247-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb247-3" tabindex="-1"></a><span class="fu">summary</span>(suob)</span></code></pre></div>
<ul>
<li>Create a <code>survfit</code> object <code>s.all</code>, which does the
default calculations for a Kaplan–Meier
analysis of the overall (marginal) survival curve.</li>
</ul>
<div class="sourceCode" id="cb248"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb248-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb248-1" tabindex="-1"></a>s.all <span class="ot">&lt;-</span> <span class="fu">survfit</span>(suob <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> orca)</span></code></pre></div>
<p>See the structure of this object and apply <code>print()</code> method on it, too.
Look at the results; what do you find?
% Try also <code>summary()</code> and see the outcome.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb249-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb249-1" tabindex="-1"></a>s.all</span>
<span id="cb249-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb249-2" tabindex="-1"></a><span class="fu">str</span>(s.all)</span></code></pre></div>
<ul>
<li>The <code>summary</code> method for
a <code>survfit</code> object would return a lengthy life table.
However, the <code>plot</code> method with default
arguments offers the Kaplan–Meier curve
for a conventional illustration of the survival experience in the whole patient group.
Alternatively, instead of graphing survival proportions,
one can draw a curve describing their complements: the cumulative mortality proportions. This curve is drawn together with the survival curve as the
result of the second command line below.</li>
</ul>
<div class="sourceCode" id="cb250"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb250-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb250-1" tabindex="-1"></a><span class="fu">plot</span>(s.all)</span>
<span id="cb250-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb250-2" tabindex="-1"></a><span class="fu">lines</span>(s.all, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">mark.time =</span> F, <span class="at">conf.int =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The effect of option <code>mark.time=F</code> is to omit
marking the times when censorings occurred.</p>
</div>
<div id="total-mortality-by-stage" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Total mortality by stage<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-by-stage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tumour stage is an important prognostic factor in cancer survival studies.</p>
<ul>
<li>Plot separate cumulative mortality curves for the different stage groups
marking them with different colours, the order which you may define yourself.
Also find the median survival time for each stage.</li>
</ul>
<div class="sourceCode" id="cb251"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb251-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb251-1" tabindex="-1"></a>s.stg <span class="ot">&lt;-</span> <span class="fu">survfit</span>(suob <span class="sc">~</span> stage, <span class="at">data =</span> orca)</span>
<span id="cb251-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb251-2" tabindex="-1"></a>col5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb251-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb251-3" tabindex="-1"></a><span class="fu">plot</span>(s.stg, <span class="at">col =</span> col5, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span>)</span>
<span id="cb251-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb251-4" tabindex="-1"></a>s.stg</span></code></pre></div>
<ul>
<li>Create now two parallel plots of which the first one describes the
cumulative hazards
and the second one graphs the log-cumulative hazards against log-time
for the different stages. Compare the two presentations
with each other and with the one in the previous item.</li>
</ul>
<div class="sourceCode" id="cb252"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb252-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb252-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-2" tabindex="-1"></a><span class="fu">plot</span>(s.stg, <span class="at">col =</span> col5, <span class="at">fun =</span> <span class="st">&quot;cumhaz&quot;</span>, <span class="at">main =</span> <span class="st">&quot;cum. hazards&quot;</span>)</span>
<span id="cb252-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-3" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb252-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-4" tabindex="-1"></a>  s.stg, </span>
<span id="cb252-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-5" tabindex="-1"></a>  <span class="at">col =</span> col5, </span>
<span id="cb252-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-6" tabindex="-1"></a>  <span class="at">fun =</span> <span class="st">&quot;cloglog&quot;</span>, </span>
<span id="cb252-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;cloglog: log cum.haz&quot;</span></span>
<span id="cb252-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb252-8" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li><p>If the survival times were <em>exponentially</em>
distributed in a given (sub)population
the corresponding cloglog-curve should follow an approximately linear pattern.
Could this be the case here in the different stages?</p></li>
<li><p>Also, if the survival distributions of the different subpopulations would
obey the <em>proportional hazards</em> model, the vertical distance between the
cloglog-curves should be approximately constant over the time axis.
Do these curves indicate serious deviation from the proportional hazards assumption?</p></li>
<li><p>In the lecture handouts it was observed that
the crude contrast between males and females in total mortality appears
unclear, but the age-adjustment in the Cox model provided a more
expected hazard ratio estimate.
We shall examine the confounding by age somewhat closer.
First categorize the continuous age variable
into, say, three categories by function <code>cut()</code>
using suitable breakpoints, like 55 and 75 years, and
cross-tabulate sex and age group:</p></li>
</ul>
<div class="sourceCode" id="cb253"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb253-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb253-1" tabindex="-1"></a>orca<span class="sc">$</span>agegr <span class="ot">&lt;-</span> <span class="fu">cut</span>(orca<span class="sc">$</span>age, <span class="at">br =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">55</span>, <span class="dv">75</span>, <span class="dv">95</span>))</span>
<span id="cb253-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb253-2" tabindex="-1"></a><span class="fu">stat.table</span>(<span class="fu">list</span>(sex, agegr), <span class="fu">list</span>(<span class="fu">count</span>(), <span class="fu">percent</span>(agegr)),</span>
<span id="cb253-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb253-3" tabindex="-1"></a>  <span class="at">margins =</span> <span class="cn">TRUE</span>, </span>
<span id="cb253-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb253-4" tabindex="-1"></a>  <span class="at">data =</span> orca</span>
<span id="cb253-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb253-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Male patients are clearly younger than females in these data.</p>
<p>Now, plot Kaplan–Meier curves jointly classified by sex and age.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb254-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-1" tabindex="-1"></a>s.agrx <span class="ot">&lt;-</span> <span class="fu">survfit</span>(suob <span class="sc">~</span> agegr <span class="sc">+</span> sex, <span class="at">data =</span> orca)</span>
<span id="cb254-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb254-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-3" tabindex="-1"></a><span class="fu">plot</span>(s.agrx,</span>
<span id="cb254-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-4" tabindex="-1"></a>  <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb254-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dv">3</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb254-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb254-6" tabindex="-1"></a>)</span></code></pre></div>
<p>In each age band the mortality curve for males is on a higher level
than that for females.</p>
</div>
<div id="event-specific-cumulative-mortality-curves" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Event-specific cumulative mortality curves<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#event-specific-cumulative-mortality-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We move on to analysing cumulative mortalities for the
two causes of death separately, first overall and then
by prognostic factors.</p>
<ul>
<li>Use the <code>survfit</code>-function in <code>survival</code> package with option <code>type="mstate"</code>.</li>
</ul>
<div class="sourceCode" id="cb255"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb255-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb255-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb255-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb255-2" tabindex="-1"></a>cif1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, event, <span class="at">type =</span> <span class="st">&quot;mstate&quot;</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb255-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb255-3" tabindex="-1"></a>  <span class="at">data =</span> orca</span>
<span id="cb255-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb255-4" tabindex="-1"></a>)</span>
<span id="cb255-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb255-5" tabindex="-1"></a><span class="fu">str</span>(cif1)</span></code></pre></div>
<ul>
<li>One could apply here the plot method of the survfit object to plot the
cumulative incidences for each cause. However, we suggest that you use
instead a simple function <code>plotCIF()</code> found in the <code>Epi</code> package.
The main arguments are</li>
</ul>
<table>
<tbody>
<tr class="odd">
<td align="left"><code>data</code></td>
<td align="left">data frame created by function }<code>survfit()</code></td>
</tr>
<tr class="even">
<td align="left"><code>event</code></td>
<td align="left">indicator for the event: values 1 or 2.</td>
</tr>
</tbody>
</table>
<p>Other arguments are like in the ordinary <code>plot()</code> function.</p>
<ul>
<li>Draw two parallel plots describing
the overall cumulative incidence curves for both causes of death</li>
</ul>
<div class="sourceCode" id="cb256"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb256-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb256-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb256-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb256-2" tabindex="-1"></a><span class="fu">plotCIF</span>(cif1, <span class="dv">1</span>, <span class="at">main =</span> <span class="st">&quot;Cancer death&quot;</span>)</span>
<span id="cb256-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb256-3" tabindex="-1"></a><span class="fu">plotCIF</span>(cif1, <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Other deaths&quot;</span>)</span></code></pre></div>
<ul>
<li>Compute the estimated
cumulative incidences by stage for both causes of death.
Now you have to add variable <code>stage</code> to survfit-function.</li>
</ul>
<p>See the structure of the resulting object, in which you should
observe strata variable containing the stage grouping variable. Plot the pertinent curves in two parallel graphs.
Cut the <span class="math inline">\(y\)</span>-axis for a more efficient graphical presentation</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb257-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-1" tabindex="-1"></a>col5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb257-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-2" tabindex="-1"></a>cif2 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, event, <span class="at">type =</span> <span class="st">&quot;mstate&quot;</span>) <span class="sc">~</span> stage,</span>
<span id="cb257-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-3" tabindex="-1"></a>  <span class="at">data =</span> orca</span>
<span id="cb257-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-4" tabindex="-1"></a>)</span>
<span id="cb257-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-5" tabindex="-1"></a><span class="fu">str</span>(cif2)</span>
<span id="cb257-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-6" tabindex="-1"></a></span>
<span id="cb257-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb257-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-8" tabindex="-1"></a><span class="fu">plotCIF</span>(cif2, <span class="dv">1</span>,</span>
<span id="cb257-9"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-9" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Cancer death by stage&quot;</span>,</span>
<span id="cb257-10"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-10" tabindex="-1"></a>  <span class="at">col =</span> col5, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb257-11"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-11" tabindex="-1"></a>)</span>
<span id="cb257-12"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-12" tabindex="-1"></a><span class="fu">plotCIF</span>(cif2, <span class="dv">2</span>,</span>
<span id="cb257-13"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-13" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Other deaths by stage&quot;</span>,</span>
<span id="cb257-14"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-14" tabindex="-1"></a>  <span class="at">col =</span> col5, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb257-15"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb257-15" tabindex="-1"></a>)</span></code></pre></div>
<p>Compare the two plots. What would you conclude about the
effect of stage on the two causes of death?</p>
<ul>
<li>Using another function <code>stackedCIF()</code> in <code>Epi</code> you can
put the two cumulative incidence curves in one graph but stacked upon one another such that
the lower curve is for the cancer deaths and the upper curve is for total mortality,
and the vertical difference between the two curves describes the
cumulative mortality from other causes. You can also add some colours for the different zones:</li>
</ul>
<div class="sourceCode" id="cb258"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb258-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb258-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb258-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb258-2" tabindex="-1"></a><span class="fu">stackedCIF</span>(cif1, <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;gray70&quot;</span>, <span class="st">&quot;gray85&quot;</span>))</span></code></pre></div>
</div>
<div id="regression-modelling-of-overall-mortality." class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Regression modelling of overall mortality.<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#regression-modelling-of-overall-mortality." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Fit the semiparametric proportional hazards
regression model, a.k.a. the Cox model, on all deaths including
sex, age and stage as covariates. Use function
<code>coxph()</code> in package <code>survival</code>.
It is often useful to center and scale
continuous covariates like <code>age</code> here.
The estimated rate ratios and their confidence intervals
can also here be displayed by applying <code>ci.lin()</code>
on the fitted model object.</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb259-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb259-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">show.signif.stars =</span> <span class="cn">FALSE</span>)</span>
<span id="cb259-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb259-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(suob <span class="sc">~</span> sex <span class="sc">+</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span> stage, <span class="at">data =</span> orca)</span>
<span id="cb259-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb259-3" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb259-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb259-4" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m1), <span class="dv">4</span>)</span></code></pre></div>
<p>Look at the results. What are the main findings?</p>
<ul>
<li>Check whether the data are sufficiently consistent with the
assumption of proportional hazards with respect to each of
the variables separately
as well as globally, using the <code>cox.zph()</code> function.</li>
</ul>
<div class="sourceCode" id="cb260"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb260-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb260-1" tabindex="-1"></a><span class="fu">cox.zph</span>(m1)</span></code></pre></div>
<ul>
<li>No evidence against proportionality assumption could apparently be found.
Moreover, no difference can be observed between stages I and II in the estimates.
On the other hand, the
group with stage unknown is a complex mixture of patients from various
true stages. Therefore, it may be prudent to exclude these subjects from the data
and to pool the first two stage groups into one. After that fit a model in
the reduced data with the new stage variable.</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb261-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb261-1" tabindex="-1"></a>orca2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(orca, stage <span class="sc">!=</span> <span class="st">&quot;unkn&quot;</span>)</span>
<span id="cb261-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb261-2" tabindex="-1"></a>orca2<span class="sc">$</span>st3 <span class="ot">&lt;-</span> <span class="fu">Relevel</span>(orca2<span class="sc">$</span>stage, <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb261-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb261-3" tabindex="-1"></a><span class="fu">levels</span>(orca2<span class="sc">$</span>st3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I-II&quot;</span>, <span class="st">&quot;III&quot;</span>, <span class="st">&quot;IV&quot;</span>)</span>
<span id="cb261-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb261-4" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, . <span class="sc">~</span> . <span class="sc">-</span> stage <span class="sc">+</span> st3, <span class="at">data =</span> orca2)</span>
<span id="cb261-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb261-5" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m2), <span class="dv">4</span>)</span></code></pre></div>
<ul>
<li>Plot the predicted cumulative mortality curves by stage,
jointly stratified by sex and age, focusing
only on 40 and 80 year old patients, respectively,
based on the fitted model <code>m2</code>.
You need to create a new artificial data frame
containing the desired values for the covariates.</li>
</ul>
<div class="sourceCode" id="cb262"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb262-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-1" tabindex="-1"></a>newd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb262-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-2" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Male&quot;</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">&quot;Female&quot;</span>, <span class="dv">6</span>)),</span>
<span id="cb262-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">40</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">80</span>, <span class="dv">3</span>)), <span class="dv">2</span>),</span>
<span id="cb262-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-4" tabindex="-1"></a>  <span class="at">st3 =</span> <span class="fu">rep</span>(<span class="fu">levels</span>(orca2<span class="sc">$</span>st3), <span class="dv">4</span>)</span>
<span id="cb262-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-5" tabindex="-1"></a>)</span>
<span id="cb262-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-6" tabindex="-1"></a>newd</span>
<span id="cb262-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-7" tabindex="-1"></a>col3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb262-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb262-9"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-9" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb262-10"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-10" tabindex="-1"></a>  <span class="fu">survfit</span>(</span>
<span id="cb262-11"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-11" tabindex="-1"></a>    m2, <span class="at">newdata =</span> <span class="fu">subset</span>(newd, sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span> <span class="sc">&amp;</span> age <span class="sc">==</span> <span class="dv">40</span>)</span>
<span id="cb262-12"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-12" tabindex="-1"></a>  ),</span>
<span id="cb262-13"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-13" tabindex="-1"></a>  <span class="at">col =</span> col3, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span></span>
<span id="cb262-14"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-14" tabindex="-1"></a>)</span>
<span id="cb262-15"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-15" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb262-16"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-16" tabindex="-1"></a>  <span class="fu">survfit</span>(</span>
<span id="cb262-17"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-17" tabindex="-1"></a>    m2, <span class="at">newdata =</span> <span class="fu">subset</span>(newd, sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span> age <span class="sc">==</span> <span class="dv">40</span>)</span>
<span id="cb262-18"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-18" tabindex="-1"></a>  ),</span>
<span id="cb262-19"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-19" tabindex="-1"></a>  <span class="at">col =</span> col3, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span></span>
<span id="cb262-20"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-20" tabindex="-1"></a>)</span>
<span id="cb262-21"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-21" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb262-22"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-22" tabindex="-1"></a>  <span class="fu">survfit</span>(</span>
<span id="cb262-23"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-23" tabindex="-1"></a>    m2, <span class="at">newdata =</span> <span class="fu">subset</span>(newd, sex <span class="sc">==</span> <span class="st">&quot;Male&quot;</span> <span class="sc">&amp;</span> age <span class="sc">==</span> <span class="dv">80</span>)</span>
<span id="cb262-24"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-24" tabindex="-1"></a>  ),</span>
<span id="cb262-25"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-25" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">col =</span> col3, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span></span>
<span id="cb262-26"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-26" tabindex="-1"></a>)</span>
<span id="cb262-27"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-27" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb262-28"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-28" tabindex="-1"></a>  <span class="fu">survfit</span>(</span>
<span id="cb262-29"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-29" tabindex="-1"></a>    m2, <span class="at">newdata =</span> <span class="fu">subset</span>(newd, sex <span class="sc">==</span> <span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span> age <span class="sc">==</span> <span class="dv">80</span>)</span>
<span id="cb262-30"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-30" tabindex="-1"></a>  ),</span>
<span id="cb262-31"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-31" tabindex="-1"></a>  <span class="at">col =</span> col3, <span class="at">fun =</span> <span class="st">&quot;event&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">mark.time =</span> <span class="cn">FALSE</span></span>
<span id="cb262-32"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb262-32" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="modelling-event-specific-hazards" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Modelling event-specific hazards<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#modelling-event-specific-hazards" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Fit the Cox model for the cause-specific hazard of cancer deaths
with the same covariates as above. In this case
only cancer deaths are counted as events and deaths from other causes
are included into censorings.</li>
</ul>
<div class="sourceCode" id="cb263"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb263-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-1" tabindex="-1"></a>m2haz1 <span class="ot">&lt;-</span> </span>
<span id="cb263-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-2" tabindex="-1"></a>  <span class="fu">coxph</span>(</span>
<span id="cb263-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-3" tabindex="-1"></a>    <span class="fu">Surv</span>(time, event <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> sex <span class="sc">+</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span> st3, </span>
<span id="cb263-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-4" tabindex="-1"></a>    <span class="at">data =</span> orca2</span>
<span id="cb263-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-5" tabindex="-1"></a>  )</span>
<span id="cb263-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-6" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m2haz1), <span class="dv">4</span>)</span>
<span id="cb263-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb263-7" tabindex="-1"></a><span class="fu">cox.zph</span>(m2haz1)</span></code></pre></div>
<p>Compare the results with those of model <code>m2</code>. What are the major differences?</p>
<ul>
<li>Fit a similar model for deaths from other causes and compare the results.</li>
</ul>
<div class="sourceCode" id="cb264"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb264-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-1" tabindex="-1"></a>m2haz2 <span class="ot">&lt;-</span> </span>
<span id="cb264-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-2" tabindex="-1"></a>  <span class="fu">coxph</span>(</span>
<span id="cb264-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-3" tabindex="-1"></a>    <span class="fu">Surv</span>(time, event <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">~</span> sex <span class="sc">+</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span> st3, </span>
<span id="cb264-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-4" tabindex="-1"></a>    <span class="at">data =</span> orca2</span>
<span id="cb264-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-5" tabindex="-1"></a>  )</span>
<span id="cb264-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-6" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m2haz2), <span class="dv">4</span>)</span>
<span id="cb264-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb264-7" tabindex="-1"></a><span class="fu">cox.zph</span>(m2haz2)</span></code></pre></div>
<!-- % -  -->
<!-- % Finally, fit the Fine--Gray model for the hazard of the subdistribution -->
<!-- % for cancer deaths with the same covariates as above. For this you have to -->
<!-- % first load package `cmprsk`, containing the necessary function -->
<!-- % `crr()`, and attach the data frame. -->
<!-- % ```{r fg1, echo=TRUE,eval=FALSE} -->
<!-- % library(cmprsk) -->
<!-- % attach(orca2) -->
<!-- % m2fg1 <- crr(time, event, cov1 = model.matrix(m2), failcode=1) -->
<!-- % summary(m2fg1, Exp=T) -->
<!-- % @ -->
<!-- %  -->
<!-- % Compare the results with those of model `m2` and `m2haz1`. -->
<!-- %  -->
<!-- % -  -->
<!-- %  Fit a similar model for deaths from other causes and compare the results. -->
<!-- % ```{r fg2, echo=TRUE,eval=FALSE} -->
<!-- % m2fg2 <- crr(time, event, cov1 = model.matrix(m2), failcode=2) -->
<!-- % summary(m2fg2, Exp=T) -->
<!-- % @ -->
</div>
<div id="lexis-object-with-multi-state-set-up" class="section level2 hasAnchor" number="11.8">
<h2><span class="header-section-number">11.8</span> Lexis object with multi-state set-up<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#lexis-object-with-multi-state-set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before entering to multi-state analyses, it might be instructive to apply some Lexis tools to illustrate the competing-risks set-up.
More detailed explanation of these tools will be given by Bendix later.</p>
<ul>
<li>Form a <code>Lexis</code> object from the data frame and
print a summary of it. We shall name the main (and only) time axis
in this object as <code>stime</code>.</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb265-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-1" tabindex="-1"></a>orca.lex <span class="ot">&lt;-</span> <span class="fu">Lexis</span>(</span>
<span id="cb265-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-2" tabindex="-1"></a>  <span class="at">exit =</span> <span class="fu">list</span>(<span class="at">stime =</span> time),</span>
<span id="cb265-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-3" tabindex="-1"></a>  <span class="at">exit.status =</span> <span class="fu">factor</span>(event,</span>
<span id="cb265-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-4" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Alive&quot;</span>, <span class="st">&quot;Oral ca. death&quot;</span>, <span class="st">&quot;Other death&quot;</span>)</span>
<span id="cb265-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-5" tabindex="-1"></a>  ),</span>
<span id="cb265-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-6" tabindex="-1"></a>  <span class="at">data =</span> orca</span>
<span id="cb265-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-7" tabindex="-1"></a>)</span>
<span id="cb265-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb265-8" tabindex="-1"></a><span class="fu">summary</span>(orca.lex)</span></code></pre></div>
<ul>
<li>Draw a box diagram of the two-state set-up of competing transitions. Run first th e following command line</li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb266-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb266-1" tabindex="-1"></a><span class="fu">boxes</span>(orca.lex)</span></code></pre></div>
<p>Now, move the cursor to the point in the graphics window, at which you wish to put the box for <em>Alive</em>, and click. Next, move
the cursor to the point at which you wish to have the box for <em>Oral ca. death</em>, and click. Finally, do the same with the box for <em>Other death</em>.
If you are not happy with the outcome, run the command line again and repeat the necessary mouse moves and clicks.</p>
</div>
<div id="optional-poisson-regression-as-an-alternative-to-cox-model" class="section level2 hasAnchor" number="11.9">
<h2><span class="header-section-number">11.9</span> Optional: Poisson regression as an alternative to Cox model<a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#optional-poisson-regression-as-an-alternative-to-cox-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It can be shown that the Cox model with an unspecified form for the
baseline hazard <span class="math inline">\(\lambda_0(t)\)</span> is mathematically equivalent
to the following kind of Poisson regression model.
Time is treated as a categorical factor with
a dense division of the time axis
into disjoint intervals or <em>timebands</em> such that
only one outcome event occurs in each timeband.
The model formula contains this time factor plus the desired
explanatory terms.</p>
<p>A sufficient division of time axis is obtained by
first setting the break points
between adjacent timebands to be those time points at which an outcome event has been observed to occur. Then,
the pertinent <code>lexis</code> object is created
and after that it will be split according to those breakpoints.
Finally, the Poisson regression model is fitted
on the splitted <code>lexis</code> object using function <code>glm()</code> with appropriate specifications.</p>
<p>We shall now demonstrate the numerical equivalence of the Cox model
<code>m2haz1</code> for oral cancer mortality that was fitted above,
and the corresponding Poisson regression.</p>
<ul>
<li>First we form the necessary <code>lexis</code> object by just taking
the relevant subset of the already available <code>orca.lex</code> object.
Upon that the three-level stage factor <code>st3</code> is created
as above.</li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb267-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb267-1" tabindex="-1"></a>orca2.lex <span class="ot">&lt;-</span> <span class="fu">subset</span>(orca.lex, stage <span class="sc">!=</span> <span class="st">&quot;unkn&quot;</span>)</span>
<span id="cb267-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb267-2" tabindex="-1"></a>orca2.lex<span class="sc">$</span>st3 <span class="ot">&lt;-</span> <span class="fu">Relevel</span>(orca2<span class="sc">$</span>stage, <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb267-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb267-3" tabindex="-1"></a><span class="fu">levels</span>(orca2.lex<span class="sc">$</span>st3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I-II&quot;</span>, <span class="st">&quot;III&quot;</span>, <span class="st">&quot;IV&quot;</span>)</span></code></pre></div>
<p>Then, the break points of time axis are taken from
the sorted event times, and the <code>lexis</code> object is
split by those breakpoints. The <code>timeband</code> factor
is defined according to the splitted survival times
stored in variable <code>stime</code>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb268-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb268-1" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> <span class="fu">sort</span>(orca2<span class="sc">$</span>time[orca2<span class="sc">$</span>event <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb268-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb268-2" tabindex="-1"></a>orca2.spl <span class="ot">&lt;-</span> </span>
<span id="cb268-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb268-3" tabindex="-1"></a>  <span class="fu">splitLexis</span>(orca2.lex, <span class="at">br =</span> cuts, <span class="at">time.scale =</span> <span class="st">&quot;stime&quot;</span>)</span>
<span id="cb268-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb268-4" tabindex="-1"></a>orca2.spl<span class="sc">$</span>timeband <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(orca2.spl<span class="sc">$</span>stime)</span></code></pre></div>
<p>As a result we now have an expanded
<code>lexis</code> object in which each subject has several rows;
as many rows as there are such timebands
during which he/she is still at risk.
The outcome status <code>lex.Xst</code> has value 0 in all those
timebands, over which the subject stays alive, but assumes
the value 1 or 2 at his/her last interval ending at the time of death.
– See now the structure of the splitted object.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb269-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb269-1" tabindex="-1"></a><span class="fu">str</span>(orca2.spl)</span>
<span id="cb269-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb269-2" tabindex="-1"></a>orca2.spl[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ]</span></code></pre></div>
<ul>
<li>We are ready to fit the desired Poisson model for oral cancer death
as the outcome. The splitted person-years are contained in <code>lex.dur</code>,
and the explanatory variables are the same as in model <code>m2haz1</code>.
– This fitting may take some time ….</li>
</ul>
<div class="sourceCode" id="cb270"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb270-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb270-1" tabindex="-1"></a>m2pois1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb270-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb270-2" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">*</span> (lex.Xst <span class="sc">==</span> <span class="st">&quot;Oral ca. death&quot;</span>) <span class="sc">~</span></span>
<span id="cb270-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb270-3" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> timeband <span class="sc">+</span> sex <span class="sc">+</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span> st3,</span>
<span id="cb270-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb270-4" tabindex="-1"></a>  <span class="at">family =</span> poisson, <span class="at">offset =</span> <span class="fu">log</span>(lex.dur), <span class="at">data =</span> orca2.spl</span>
<span id="cb270-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb270-5" tabindex="-1"></a>)</span></code></pre></div>
<p>We shall display the estimation results graphically
for the baseline hazard (per 1000 person-years)
and numerically for the rate ratios associated with the covariates.
Before doing that it is useful to count the length <code>ntb</code> of the
block occupied by baseline hazard in the whole vector of estimated parameters.
However, owing to how the splitting to timebands was done, the last regression
coefficient is necessarily
zero and better be omitted when displaying the results. Also, as each timeband
is quantitatively
named accoding to its leftmost point, it is good to compute the midpoint values <code>tbmid</code>
for the timebands</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb271-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">levels</span>(orca2.spl<span class="sc">$</span>timeband))</span>
<span id="cb271-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-2" tabindex="-1"></a>ntb <span class="ot">&lt;-</span> <span class="fu">length</span>(tb)</span>
<span id="cb271-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-3" tabindex="-1"></a>tbmid <span class="ot">&lt;-</span> (tb[<span class="sc">-</span>ntb] <span class="sc">+</span> tb[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">/</span> <span class="dv">2</span> <span class="co"># midpoints of the intervals</span></span>
<span id="cb271-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-4" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m2pois1), <span class="dv">3</span>)</span>
<span id="cb271-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb271-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-6" tabindex="-1"></a><span class="fu">plot</span>(tbmid, <span class="dv">1000</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">coef</span>(m2pois1)[<span class="dv">1</span><span class="sc">:</span>(ntb <span class="sc">-</span> <span class="dv">1</span>)]),</span>
<span id="cb271-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-7" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3000</span>), <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span></span>
<span id="cb271-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb271-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Compare the regression coefficients and their error margins
to those model <code>m2haz1</code>. Do you find any differences?
How does the estimated baseline hazard look like?</p>
<ul>
<li>The estimated baseline looks quite ragged when based on 71 separate
parameters. A smoothed estimate may be obtained by spline modelling using the tools
contained in package <code>splines</code> (see the practical of Saturday 25 May afternoon).
With the following code you will be able to fit a
reasonable spline model for the baseline hazard and
draw the estimated curve (together with a band of the 95%
confidence limits about the fitted values).
From the same model you should also obtain quite familiar results for the
rate ratios of interest.</li>
</ul>
<div class="sourceCode" id="cb272"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb272-1"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-1" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb272-2"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-2" tabindex="-1"></a>m2pspli <span class="ot">&lt;-</span> </span>
<span id="cb272-3"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-3" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb272-4"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-4" tabindex="-1"></a>    m2pois1, </span>
<span id="cb272-5"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-5" tabindex="-1"></a>    . <span class="sc">~</span> <span class="fu">ns</span>(stime, <span class="at">df =</span> <span class="dv">6</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb272-6"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-6" tabindex="-1"></a>      sex <span class="sc">+</span> <span class="fu">I</span>((age <span class="sc">-</span> <span class="dv">65</span>) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span> st3)</span>
<span id="cb272-7"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-7" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ci.exp</span>(m2pspli), <span class="dv">3</span>)</span>
<span id="cb272-8"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-8" tabindex="-1"></a>news <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb272-9"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-9" tabindex="-1"></a>  <span class="at">stime =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="at">length =</span> <span class="dv">301</span>), </span>
<span id="cb272-10"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-10" tabindex="-1"></a>  <span class="at">lex.dur =</span> <span class="dv">1000</span>, </span>
<span id="cb272-11"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-11" tabindex="-1"></a>  <span class="at">sex =</span> <span class="st">&quot;Female&quot;</span>,</span>
<span id="cb272-12"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-12" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">65</span>, </span>
<span id="cb272-13"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-13" tabindex="-1"></a>  <span class="at">st3 =</span> <span class="st">&quot;I-II&quot;</span></span>
<span id="cb272-14"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-14" tabindex="-1"></a>)</span>
<span id="cb272-15"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-15" tabindex="-1"></a>blhaz <span class="ot">&lt;-</span> </span>
<span id="cb272-16"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-16" tabindex="-1"></a>  <span class="fu">predict</span>(m2pspli, <span class="at">newdata =</span> news, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb272-17"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-17" tabindex="-1"></a>blh95 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(blhaz<span class="sc">$</span>fit, blhaz<span class="sc">$</span>se.fit) <span class="sc">%*%</span> <span class="fu">ci.mat</span>()</span>
<span id="cb272-18"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-18" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb272-19"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-19" tabindex="-1"></a><span class="fu">matplot</span>(news<span class="sc">$</span>stime, <span class="fu">exp</span>(blh95),</span>
<span id="cb272-20"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-20" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb272-21"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-21" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">3</span>), <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3000</span>)</span>
<span id="cb272-22"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#cb272-22" tabindex="-1"></a>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphics-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-splitting-time-scales-and-smr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SPE-R/SPE/edit/master/pracs-book/oral-e.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPE-R-2024-practicals.pdf", "SPE-R-2024-practicals.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
