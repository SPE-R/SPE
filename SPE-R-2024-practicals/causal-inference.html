<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Causal inference | Statistical Practice in Epidemiology with R</title>
  <meta name="description" content="This is the SPE-R 2024 exercises book" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Causal inference | Statistical Practice in Epidemiology with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the SPE-R 2024 exercises book" />
  <meta name="github-repo" content="spe-r/spe" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Causal inference | Statistical Practice in Epidemiology with R" />
  
  <meta name="twitter:description" content="This is the SPE-R 2024 exercises book" />
  

<meta name="author" content="Krista Fischer" />
<meta name="author" content="Martyn Plummer" />
<meta name="author" content="Janne Pitkäniemi" />
<meta name="author" content="Bendix Carstensen" />
<meta name="author" content="Damien Georges" />
<meta name="author" content="Esa Läärä" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="poisson-regression-analysis-of-curved-effects.html"/>
<link rel="next" href="graphics-with-ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SPE-R practicals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html"><i class="fa fa-check"></i><b>1</b> Practice with basic R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-working-directory"><i class="fa fa-check"></i><b>1.1</b> The working directory</a></li>
<li class="chapter" data-level="1.2" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#the-workspace"><i class="fa fa-check"></i><b>1.2</b> The workspace</a></li>
<li class="chapter" data-level="1.3" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>1.3</b> Using R as a calculator</a></li>
<li class="chapter" data-level="1.4" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#sequences"><i class="fa fa-check"></i><b>1.5</b> Sequences</a></li>
<li class="chapter" data-level="1.6" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#displaying-and-changing-parts-of-a-vector-indexing"><i class="fa fa-check"></i><b>1.6</b> Displaying and changing parts of a vector (indexing)</a></li>
<li class="chapter" data-level="1.7" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#lists"><i class="fa fa-check"></i><b>1.7</b> Lists</a></li>
<li class="chapter" data-level="1.8" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data frames</a></li>
<li class="chapter" data-level="1.9" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#working-with-built-in-data-frames"><i class="fa fa-check"></i><b>1.9</b> Working with built-in data frames</a></li>
<li class="chapter" data-level="1.10" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#referencing-parts-of-the-data-frame-indexing"><i class="fa fa-check"></i><b>1.10</b> Referencing parts of the data frame (indexing)</a></li>
<li class="chapter" data-level="1.11" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#summaries"><i class="fa fa-check"></i><b>1.11</b> Summaries</a></li>
<li class="chapter" data-level="1.12" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#generating-new-variables"><i class="fa fa-check"></i><b>1.12</b> Generating new variables</a></li>
<li class="chapter" data-level="1.13" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#turning-a-variable-into-a-factor"><i class="fa fa-check"></i><b>1.13</b> Turning a variable into a factor</a></li>
<li class="chapter" data-level="1.14" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#frequency-tables"><i class="fa fa-check"></i><b>1.14</b> Frequency tables</a></li>
<li class="chapter" data-level="1.15" data-path="practice-with-basic-r.html"><a href="practice-with-basic-r.html#grouping-the-values-of-a-numeric-variable"><i class="fa fa-check"></i><b>1.15</b> Grouping the values of a numeric variable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html"><i class="fa fa-check"></i><b>2</b> Reading data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-sources"><i class="fa fa-check"></i><b>2.2</b> Data sources</a></li>
<li class="chapter" data-level="2.3" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#data-in-text-files"><i class="fa fa-check"></i><b>2.3</b> Data in text files</a></li>
<li class="chapter" data-level="2.4" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#things-that-can-go-wrong"><i class="fa fa-check"></i><b>2.4</b> Things that can go wrong</a></li>
<li class="chapter" data-level="2.5" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#forgetting-the-headers"><i class="fa fa-check"></i><b>2.5</b> Forgetting the headers</a></li>
<li class="chapter" data-level="2.6" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#using-the-wrong-separator"><i class="fa fa-check"></i><b>2.6</b> Using the wrong separator</a></li>
<li class="chapter" data-level="2.7" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#mis-specifying-the-representation-of-missing-values"><i class="fa fa-check"></i><b>2.7</b> Mis-specifying the representation of missing values</a></li>
<li class="chapter" data-level="2.8" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#spreadsheet-data"><i class="fa fa-check"></i><b>2.8</b> Spreadsheet data</a></li>
<li class="chapter" data-level="2.9" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-data-from-the-internet"><i class="fa fa-check"></i><b>2.9</b> Reading data from the Internet</a></li>
<li class="chapter" data-level="2.10" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#reading-from-the-clipboard"><i class="fa fa-check"></i><b>2.10</b> Reading from the clipboard</a></li>
<li class="chapter" data-level="2.11" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#binary-data"><i class="fa fa-check"></i><b>2.11</b> Binary data</a></li>
<li class="chapter" data-level="2.12" data-path="reading-data-into-r.html"><a href="reading-data-into-r.html#summary"><i class="fa fa-check"></i><b>2.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data manipulation with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#the-births-data"><i class="fa fa-check"></i><b>3.2</b> The <code>births</code> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#tibble-vs-data.frame"><i class="fa fa-check"></i><b>3.3</b> <code>tibble</code> vs <code>data.frame</code></a></li>
<li class="chapter" data-level="3.4" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#piping-functions"><i class="fa fa-check"></i><b>3.4</b> Piping functions</a></li>
<li class="chapter" data-level="3.5" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#mutate-columns"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> columns</a></li>
<li class="chapter" data-level="3.6" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#select-columns-filter-and-arrange-rows"><i class="fa fa-check"></i><b>3.6</b> <code>select</code> columns, <code>filter</code> and <code>arrange</code> rows</a></li>
<li class="chapter" data-level="3.7" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#group_by-and-summarise-data"><i class="fa fa-check"></i><b>3.7</b> <code>group_by</code> and <code>summarise</code> data</a></li>
<li class="chapter" data-level="3.8" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#multiple-grouping"><i class="fa fa-check"></i><b>3.8</b> Multiple grouping</a></li>
<li class="chapter" data-level="3.9" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bind-and-join-tables"><i class="fa fa-check"></i><b>3.9</b> Bind and join tables</a></li>
<li class="chapter" data-level="3.10" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#data-visualization-with-ggplot2"><i class="fa fa-check"></i><b>3.10</b> Data Visualization with ggplot2</a></li>
<li class="chapter" data-level="3.11" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#pivoting-data-with-tidyr"><i class="fa fa-check"></i><b>3.11</b> pivoting data with tidyr</a></li>
<li class="chapter" data-level="3.12" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#reading-files-with-readr"><i class="fa fa-check"></i><b>3.12</b> reading files with readr</a></li>
<li class="chapter" data-level="3.13" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#string-manipulation-with-stringr"><i class="fa fa-check"></i><b>3.13</b> String manipulation with stringr</a></li>
<li class="chapter" data-level="3.14" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#purrr-package-to-apply-functions-to-list"><i class="fa fa-check"></i><b>3.14</b> purrr package to apply functions to list</a></li>
<li class="chapter" data-level="3.15" data-path="data-manipulation-with-tidyverse.html"><a href="data-manipulation-with-tidyverse.html#bonus-rendering-tables"><i class="fa fa-check"></i><b>3.15</b> Bonus: Rendering tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tabulation.html"><a href="tabulation.html"><i class="fa fa-check"></i><b>4</b> Tabulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tabulation.html"><a href="tabulation.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tabulation.html"><a href="tabulation.html#the-births-data-1"><i class="fa fa-check"></i><b>4.2</b> The births data</a></li>
<li class="chapter" data-level="4.3" data-path="tabulation.html"><a href="tabulation.html#one-way-tables"><i class="fa fa-check"></i><b>4.3</b> One-way tables</a></li>
<li class="chapter" data-level="4.4" data-path="tabulation.html"><a href="tabulation.html#improving-the-presentation-of-tables"><i class="fa fa-check"></i><b>4.4</b> Improving the Presentation of Tables</a></li>
<li class="chapter" data-level="4.5" data-path="tabulation.html"><a href="tabulation.html#two-way-tables"><i class="fa fa-check"></i><b>4.5</b> Two-way Tables</a></li>
<li class="chapter" data-level="4.6" data-path="tabulation.html"><a href="tabulation.html#printing"><i class="fa fa-check"></i><b>4.6</b> Printing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-in-r.html"><a href="graphics-in-r.html"><i class="fa fa-check"></i><b>5</b> Graphics in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#simple-plot-on-the-screen"><i class="fa fa-check"></i><b>5.1</b> Simple plot on the screen</a></li>
<li class="chapter" data-level="5.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#colours"><i class="fa fa-check"></i><b>5.2</b> Colours</a></li>
<li class="chapter" data-level="5.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#adding-to-a-plot"><i class="fa fa-check"></i><b>5.3</b> Adding to a plot</a></li>
<li class="chapter" data-level="5.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#using-indexing-for-plot-elements"><i class="fa fa-check"></i><b>5.4</b> Using indexing for plot elements</a></li>
<li class="chapter" data-level="5.5" data-path="graphics-in-r.html"><a href="graphics-in-r.html#generating-colours"><i class="fa fa-check"></i><b>5.5</b> Generating colours</a></li>
<li class="chapter" data-level="5.6" data-path="graphics-in-r.html"><a href="graphics-in-r.html#saving-your-graphs-for-use-in-other-documents"><i class="fa fa-check"></i><b>5.6</b> Saving your graphs for use in other documents</a></li>
<li class="chapter" data-level="5.7" data-path="graphics-in-r.html"><a href="graphics-in-r.html#interacting-with-a-plot"><i class="fa fa-check"></i><b>5.7</b> Interacting with a plot</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><i class="fa fa-check"></i><b>6</b> Analysis of hazard rates, their ratios and differences and binary regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#hand-calculations-for-a-single-rate"><i class="fa fa-check"></i><b>6.1</b> Hand calculations for a single rate</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-logarithmic-link"><i class="fa fa-check"></i><b>6.2</b> Poisson model for a single rate with logarithmic link</a></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-for-a-single-rate-with-identity-link"><i class="fa fa-check"></i><b>6.3</b> Poisson model for a single rate with identity link</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#poisson-model-assuming-the-same-rate-for-several-periods"><i class="fa fa-check"></i><b>6.4</b> Poisson model assuming the same rate for several periods</a></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-ratio"><i class="fa fa-check"></i><b>6.5</b> Analysis of rate ratio</a></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#analysis-of-rate-difference"><i class="fa fa-check"></i><b>6.6</b> Analysis of rate difference</a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#binary-regression"><i class="fa fa-check"></i><b>6.7</b> Binary regression</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html"><a href="analysis-of-hazard-rates-their-ratios-and-differences-and-binary-regression.html#optionalhomework-hand-calculations-and-calculations-using-matrix-tools"><i class="fa fa-check"></i><b>6.8</b> Optional/Homework: Hand calculations and calculations using matrix tools</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html"><i class="fa fa-check"></i><b>7</b> Estimation of effects: simple and more complex</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#response-and-explanatory-variables"><i class="fa fa-check"></i><b>7.1</b> Response and explanatory variables</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#data-set-births"><i class="fa fa-check"></i><b>7.2</b> Data set <code>births</code></a></li>
<li class="chapter" data-level="7.3" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#simple-estimation-with-lm-and-glm"><i class="fa fa-check"></i><b>7.3</b> Simple estimation with <code>lm()</code> and <code>glm()</code></a></li>
<li class="chapter" data-level="7.4" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#stratified-effects-and-interaction-or-effect-measure-modification"><i class="fa fa-check"></i><b>7.4</b> Stratified effects, and interaction or effect-measure modification</a></li>
<li class="chapter" data-level="7.5" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#controlling-or-adjusting-for-the-effect-of-hyp-for-sex"><i class="fa fa-check"></i><b>7.5</b> Controlling or adjusting for the effect of <code>hyp</code> for <code>sex</code></a></li>
<li class="chapter" data-level="7.6" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#numeric-exposure-simple-linear-regression-and-checking-assumptions"><i class="fa fa-check"></i><b>7.6</b> Numeric exposure, simple linear regression and checking assumptions</a></li>
<li class="chapter" data-level="7.7" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#penalized-spline-model"><i class="fa fa-check"></i><b>7.7</b> Penalized spline model</a></li>
<li class="chapter" data-level="7.8" data-path="estimation-of-effects-simple-and-more-complex.html"><a href="estimation-of-effects-simple-and-more-complex.html#analysis-of-binary-outcomes"><i class="fa fa-check"></i><b>7.8</b> Analysis of binary outcomes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html"><i class="fa fa-check"></i><b>8</b> Poisson regression &amp; analysis of curved effects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#testis-cancer-data-input-and-housekeeping"><i class="fa fa-check"></i><b>8.1</b> Testis cancer: Data input and housekeeping</a></li>
<li class="chapter" data-level="8.2" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#some-descriptive-analysis"><i class="fa fa-check"></i><b>8.2</b> Some descriptive analysis</a></li>
<li class="chapter" data-level="8.3" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#age-and-period-as-categorical-factors"><i class="fa fa-check"></i><b>8.3</b> Age and period as categorical factors</a></li>
<li class="chapter" data-level="8.4" data-path="poisson-regression-analysis-of-curved-effects.html"><a href="poisson-regression-analysis-of-curved-effects.html#generalized-additive-model-with-penalized-splines"><i class="fa fa-check"></i><b>8.4</b> Generalized additive model with penalized splines</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>9</b> Causal inference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="causal-inference.html"><a href="causal-inference.html#proper-adjustment-for-confounding-in-regression-models"><i class="fa fa-check"></i><b>9.1</b> Proper adjustment for confounding in regression models</a></li>
<li class="chapter" data-level="9.2" data-path="causal-inference.html"><a href="causal-inference.html#dag-tools-in-the-package-dagitty"><i class="fa fa-check"></i><b>9.2</b> DAG tools in the package <code>dagitty</code></a></li>
<li class="chapter" data-level="9.3" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variables-estimation-mendelian-randomization"><i class="fa fa-check"></i><b>9.3</b> Instrumental variables estimation: Mendelian randomization</a></li>
<li class="chapter" data-level="9.4" data-path="causal-inference.html"><a href="causal-inference.html#why-are-simulation-exercises-useful-for-causal-inference"><i class="fa fa-check"></i><b>9.4</b> Why are simulation exercises useful for causal inference?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>10</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#data"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#building-the-plot"><i class="fa fa-check"></i><b>10.2</b> Building the plot</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#the-ggplot2-package"><i class="fa fa-check"></i><b>10.2.1</b> The ggplot2 package</a></li>
<li class="chapter" data-level="10.2.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#geometries"><i class="fa fa-check"></i><b>10.2.2</b> Geometries</a></li>
<li class="chapter" data-level="10.2.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>10.2.3</b> Scales</a></li>
<li class="chapter" data-level="10.2.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#themes"><i class="fa fa-check"></i><b>10.2.4</b> Themes</a></li>
<li class="chapter" data-level="10.2.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#putting-everything-together"><i class="fa fa-check"></i><b>10.2.5</b> Putting everything together</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#self-study"><i class="fa fa-check"></i><b>10.3</b> Self study</a></li>
<li class="chapter" data-level="10.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-the-table-advanced-topic"><i class="fa fa-check"></i><b>10.4</b> Adding the table (advanced topic)</a></li>
<li class="chapter" data-level="10.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#references"><i class="fa fa-check"></i><b>10.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html"><i class="fa fa-check"></i><b>11</b> Survival analysis with competing risks: Oral cancer patients</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#description-of-the-data"><i class="fa fa-check"></i><b>11.1</b> Description of the data</a></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#loading-the-packages-and-the-data"><i class="fa fa-check"></i><b>11.2</b> Loading the packages and the data</a></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-kaplanmeier-analyses"><i class="fa fa-check"></i><b>11.3</b> Total mortality: Kaplan–Meier analyses</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#total-mortality-by-stage"><i class="fa fa-check"></i><b>11.4</b> Total mortality by stage</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#event-specific-cumulative-mortality-curves"><i class="fa fa-check"></i><b>11.5</b> Event-specific cumulative mortality curves</a></li>
<li class="chapter" data-level="11.6" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#regression-modelling-of-overall-mortality."><i class="fa fa-check"></i><b>11.6</b> Regression modelling of overall mortality.</a></li>
<li class="chapter" data-level="11.7" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#modelling-event-specific-hazards"><i class="fa fa-check"></i><b>11.7</b> Modelling event-specific hazards</a></li>
<li class="chapter" data-level="11.8" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#lexis-object-with-multi-state-set-up"><i class="fa fa-check"></i><b>11.8</b> Lexis object with multi-state set-up</a></li>
<li class="chapter" data-level="11.9" data-path="survival-analysis-with-competing-risks-oral-cancer-patients.html"><a href="survival-analysis-with-competing-risks-oral-cancer-patients.html#optional-poisson-regression-as-an-alternative-to-cox-model"><i class="fa fa-check"></i><b>11.9</b> Optional: Poisson regression as an alternative to Cox model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html"><i class="fa fa-check"></i><b>12</b> Time-splitting, time-scales and SMR</a>
<ul>
<li class="chapter" data-level="12.1" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#age-specific-mortality"><i class="fa fa-check"></i><b>12.1</b> Age-specific mortality</a></li>
<li class="chapter" data-level="12.2" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr"><i class="fa fa-check"></i><b>12.2</b> SMR</a></li>
<li class="chapter" data-level="12.3" data-path="time-splitting-time-scales-and-smr.html"><a href="time-splitting-time-scales-and-smr.html#smr-modeling"><i class="fa fa-check"></i><b>12.3</b> SMR modeling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><i class="fa fa-check"></i><b>13</b> Nested case-control study and case-cohort study: Risk factors of coronary heart disease</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#reading-the-cohort-data-illustrating-the-study-base-and-risk-sets"><i class="fa fa-check"></i><b>13.1</b> Reading the cohort data, illustrating the study base and risk sets</a></li>
<li class="chapter" data-level="13.2" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#nested-case-control-study"><i class="fa fa-check"></i><b>13.2</b> Nested case-control study</a></li>
<li class="chapter" data-level="13.3" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#case-cohort-study"><i class="fa fa-check"></i><b>13.3</b> Case-cohort study</a></li>
<li class="chapter" data-level="13.4" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#do-these-estimates-resemble-those-obtained-from-nested-case-control-data"><i class="fa fa-check"></i><b>13.4</b> Do these estimates resemble those obtained from nested case-control data?</a></li>
<li class="chapter" data-level="13.5" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#full-cohort-analysis-and-comparisons"><i class="fa fa-check"></i><b>13.5</b> Full cohort analysis and comparisons</a></li>
<li class="chapter" data-level="13.6" data-path="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html"><a href="nested-case-control-study-and-case-cohort-study-risk-factors-of-coronary-heart-disease.html#further-exercises-and-homework"><i class="fa fa-check"></i><b>13.6</b> Further exercises and homework</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html"><i class="fa fa-check"></i><b>14</b> Causal inference 2: Model-based estimation of causal estimands</a>
<ul>
<li class="chapter" data-level="14.1" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#control-of-confounding"><i class="fa fa-check"></i><b>14.1</b> Control of confounding</a></li>
<li class="chapter" data-level="14.2" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#generation-of-target-population-and-true-models"><i class="fa fa-check"></i><b>14.2</b> Generation of target population and true models</a></li>
<li class="chapter" data-level="14.3" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#factual-and-counterfactual-risks---associational-and-causal-contrasts"><i class="fa fa-check"></i><b>14.3</b> Factual and counterfactual risks - associational and causal contrasts</a></li>
<li class="chapter" data-level="14.4" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#outcome-modelling-and-estimation-of-causal-contrasts-by-g-formula"><i class="fa fa-check"></i><b>14.4</b> Outcome modelling and estimation of causal contrasts by g-formula</a></li>
<li class="chapter" data-level="14.5" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#inverse-probability-weighting-ipw-by-propensity-scores"><i class="fa fa-check"></i><b>14.5</b> Inverse probability weighting (IPW) by propensity scores</a></li>
<li class="chapter" data-level="14.6" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#improving-ipw-estimation-and-using-r-package-psweight"><i class="fa fa-check"></i><b>14.6</b> Improving IPW estimation and using R package <code>PSweight</code></a></li>
<li class="chapter" data-level="14.7" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#effect-of-exposure-among-those-exposed"><i class="fa fa-check"></i><b>14.7</b> Effect of exposure among those exposed</a></li>
<li class="chapter" data-level="14.8" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#augmented-ipw"><i class="fa fa-check"></i><b>14.8</b> Augmented IPW</a></li>
<li class="chapter" data-level="14.9" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#targeted-maximum-likelihood-estimation-tmle"><i class="fa fa-check"></i><b>14.9</b> Targeted maximum likelihood estimation (TMLE)</a></li>
<li class="chapter" data-level="14.10" data-path="causal-inference-2-model-based-estimation-of-causal-estimands.html"><a href="causal-inference-2-model-based-estimation-of-causal-estimands.html#tmle-with-superlearner"><i class="fa fa-check"></i><b>14.10</b> TMLE with SuperLearner</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html"><i class="fa fa-check"></i><b>15</b> Time-dependent variables and multiple states</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-dependent-variables-and-multiple-states.html"><a href="time-dependent-variables-and-multiple-states.html#the-renal-failure-dataset"><i class="fa fa-check"></i><b>15.1</b> The renal failure dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/SPE-R/SPE" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Practice in Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-inference" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Causal inference<a href="causal-inference.html#causal-inference" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="proper-adjustment-for-confounding-in-regression-models" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Proper adjustment for confounding in regression models<a href="causal-inference.html#proper-adjustment-for-confounding-in-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first exercise of this session will ask you to simulate some data
according to pre-specified causal structure (don’t take the particular
example too seriously) and see how you should adjust the analysis to
obtain correct estimates of the causal effects.</p>
<p>Suppose one is interested in the effect of beer-drinking on body weight.
Let’s <em>assume</em> that in addition to the potential effect of beer on weight, the following is true in reality:</p>
<ul>
<li>Beer-drinking has an effect on the body weight.</li>
<li>Men drink more beer than women</li>
<li>Men have higher body weight than women</li>
<li>People with higher body weight tend to have higher blood pressure</li>
<li>Beer-drinking increases blood pressure</li>
</ul>
<p>The task is to simulate a dataset in accordance with this model, and
subsequently analyse it to see, whether the results would allow us to
conclude the true association structure.</p>
<ul>
<li><p>Sketch a causal graph (not necessarily with R) to see, how should one generate the data</p></li>
<li><p>Suppose the actual effect sizes are following:</p></li>
<li><p>People who drink beer weigh on average <span class="math inline">\(2kg\)</span> more than those who don’t.</p></li>
<li><p>The probability of beer-drinking is 0.2 for females and 0.7 for males</p></li>
<li><p>Men weigh on average <span class="math inline">\(10kg\)</span> more than women.</p></li>
<li><p>One kg difference in body weight corresponds in
average to <span class="math inline">\(0.5mmHg\)</span> difference in (systolic) blood pressures.</p></li>
<li><p>Beer-drinking increases blood pressure by <span class="math inline">\(10mmHg\)</span> in average.</p></li>
<li><p>Beer-drinking has <strong>no</strong> effect on body weight.</p></li>
</ul>
<p>The <code>R</code> commands to generate the data are:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb248-1"><a href="causal-inference.html#cb248-1" tabindex="-1"></a>bdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">500</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">500</span>)))</span>
<span id="cb248-2"><a href="causal-inference.html#cb248-2" tabindex="-1"></a><span class="co"># a data frame with 500 females, 500 males</span></span>
<span id="cb248-3"><a href="causal-inference.html#cb248-3" tabindex="-1"></a>bdat<span class="sc">$</span>beer <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> bdat<span class="sc">$</span>sex)</span>
<span id="cb248-4"><a href="causal-inference.html#cb248-4" tabindex="-1"></a>bdat<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> bdat<span class="sc">$</span>sex <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb248-5"><a href="causal-inference.html#cb248-5" tabindex="-1"></a>bdat<span class="sc">$</span>bp <span class="ot">&lt;-</span> </span>
<span id="cb248-6"><a href="causal-inference.html#cb248-6" tabindex="-1"></a>  <span class="dv">110</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> bdat<span class="sc">$</span>weight <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> bdat<span class="sc">$</span>beer <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span></code></pre></div>
<ul>
<li><p>Now fit the following models for body weight as dependent
variable and beer-drinking as independent variable. Look, what is
the estimated effect size:</p></li>
<li><p>Unadjusted (just simple linear regression)</p></li>
<li><p>Adjusted for sex</p></li>
<li><p>Adjusted for sex and blood pressure</p></li>
<li><p>What would be the conclusions on the effect of beer on weight, based on the three models? Do they agree?
Which (if any) of the models gives an unbiased estimate of the
actual causal effect of interest?</p></li>
<li><p>How can the answer be seen from the graph?</p></li>
<li><p>Now change the data-generation algorithm so, that in fact beer-drinking
does increase the body weight by 2kg. Look, what are
the conclusions in the above models now.
Thus the data is generated as before, but the weight variable is computed as:</p></li>
</ul>
<div class="sourceCode" id="cb249"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb249-1"><a href="causal-inference.html#cb249-1" tabindex="-1"></a>bdat<span class="sc">$</span>weight <span class="ot">&lt;-</span> </span>
<span id="cb249-2"><a href="causal-inference.html#cb249-2" tabindex="-1"></a>  <span class="dv">60</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> bdat<span class="sc">$</span>sex <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> bdat<span class="sc">$</span>beer <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span></code></pre></div>
<ul>
<li>Suppose one is interested in the effect of beer-drinking on blood pressure instead, and is fitting a) an unadjusted model for blood pressure, with beer as an only covariate; b) a model with beer and sex as covariates. Would either a) or b) give an unbiased estimate for the effect? (You may double-check whether the simulated data is consistent with your answer).</li>
</ul>
</div>
<div id="dag-tools-in-the-package-dagitty" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> DAG tools in the package <code>dagitty</code><a href="causal-inference.html#dag-tools-in-the-package-dagitty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a software <em>DAGitty</em> (<a href="http://www.dagitty.net/">http://www.dagitty.net/</a>) and also an R package <em>dagitty</em> that can be helpful in dealing with DAGs. Let’s try to get the answer to the previous exercise using this package.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb250-1"><a href="causal-inference.html#cb250-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;dagitty&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())){</span>
<span id="cb250-2"><a href="causal-inference.html#cb250-2" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;dagitty&quot;</span>)</span>
<span id="cb250-3"><a href="causal-inference.html#cb250-3" tabindex="-1"></a>}</span>
<span id="cb250-4"><a href="causal-inference.html#cb250-4" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span></code></pre></div>
<p>Let’s recreate the graph on the lecture slide 23 (but omitting the direct causal effect of interest, <span class="math inline">\(C \rightarrow D\)</span>):</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb251-1"><a href="causal-inference.html#cb251-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag {</span></span>
<span id="cb251-2"><a href="causal-inference.html#cb251-2" tabindex="-1"></a><span class="st">    C &lt;- S -&gt; Y -&gt; U -&gt; D</span></span>
<span id="cb251-3"><a href="causal-inference.html#cb251-3" tabindex="-1"></a><span class="st">    C -&gt; Z &lt;- Y</span></span>
<span id="cb251-4"><a href="causal-inference.html#cb251-4" tabindex="-1"></a><span class="st">    Z -&gt; D</span></span>
<span id="cb251-5"><a href="causal-inference.html#cb251-5" tabindex="-1"></a><span class="st">    C &lt;- X -&gt; D</span></span>
<span id="cb251-6"><a href="causal-inference.html#cb251-6" tabindex="-1"></a><span class="st">    C -&gt; Q</span></span>
<span id="cb251-7"><a href="causal-inference.html#cb251-7" tabindex="-1"></a><span class="st">    W -&gt; D</span></span>
<span id="cb251-8"><a href="causal-inference.html#cb251-8" tabindex="-1"></a><span class="st">  }&quot;</span>)</span>
<span id="cb251-9"><a href="causal-inference.html#cb251-9" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code></pre></div>
<p><img src="SPE-R-2024-practicals_files/figure-html/dagitty2-1.png" width="672" /></p>
<p>To get a more similar look as on the slide, we must supply the coordinates (x increases from left to right, y from top to bottom):</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb252-1"><a href="causal-inference.html#cb252-1" tabindex="-1"></a><span class="fu">coordinates</span>(g) <span class="ot">&lt;-</span> </span>
<span id="cb252-2"><a href="causal-inference.html#cb252-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb252-3"><a href="causal-inference.html#cb252-3" tabindex="-1"></a>    <span class="at">x =</span> </span>
<span id="cb252-4"><a href="causal-inference.html#cb252-4" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb252-5"><a href="causal-inference.html#cb252-5" tabindex="-1"></a>        <span class="at">S =</span> <span class="dv">1</span>, <span class="at">C =</span> <span class="dv">1</span>, <span class="at">Q =</span> <span class="dv">1</span>, <span class="at">Y =</span> <span class="dv">2</span>, <span class="at">Z =</span> <span class="dv">2</span>, </span>
<span id="cb252-6"><a href="causal-inference.html#cb252-6" tabindex="-1"></a>        <span class="at">X =</span> <span class="dv">2</span>, <span class="at">U =</span> <span class="dv">3</span>, <span class="at">D =</span> <span class="dv">3</span>, <span class="at">W =</span> <span class="dv">3</span></span>
<span id="cb252-7"><a href="causal-inference.html#cb252-7" tabindex="-1"></a>      ),</span>
<span id="cb252-8"><a href="causal-inference.html#cb252-8" tabindex="-1"></a>    <span class="at">y =</span> </span>
<span id="cb252-9"><a href="causal-inference.html#cb252-9" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb252-10"><a href="causal-inference.html#cb252-10" tabindex="-1"></a>        <span class="at">U =</span> <span class="dv">1</span>, <span class="at">Y =</span> <span class="dv">1</span>, <span class="at">S =</span> <span class="dv">1</span>, <span class="at">Z =</span> <span class="dv">2</span>, <span class="at">C =</span> <span class="dv">3</span>, </span>
<span id="cb252-11"><a href="causal-inference.html#cb252-11" tabindex="-1"></a>        <span class="at">D =</span> <span class="dv">3</span>, <span class="at">X =</span> <span class="dv">4</span>, <span class="at">W =</span> <span class="dv">4</span>, <span class="at">Q =</span> <span class="dv">4</span></span>
<span id="cb252-12"><a href="causal-inference.html#cb252-12" tabindex="-1"></a>      )</span>
<span id="cb252-13"><a href="causal-inference.html#cb252-13" tabindex="-1"></a>  )</span>
<span id="cb252-14"><a href="causal-inference.html#cb252-14" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code></pre></div>
<p>Let’s look at all possible paths from <span class="math inline">\(C\)</span> to <span class="math inline">\(D\)</span>:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb253-1"><a href="causal-inference.html#cb253-1" tabindex="-1"></a><span class="fu">paths</span>(g, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)<span class="sc">$</span>paths</span></code></pre></div>
<p>As you see, one path contains a collider and is therefore a <em>closed</em> path and the others are <em>open</em>.</p>
<p>Let’s identify the minimal sets of variables needed to adjust the model for <span class="math inline">\(D\)</span> for, to obtain an unbiased estimate of the effect of <span class="math inline">\(C\)</span>. You can specify, whether you want to estimate direct or total effect of <span class="math inline">\(C\)</span>:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb254-1"><a href="causal-inference.html#cb254-1" tabindex="-1"></a><span class="fu">adjustmentSets</span>(</span>
<span id="cb254-2"><a href="causal-inference.html#cb254-2" tabindex="-1"></a>  g, <span class="at">exposure =</span> <span class="st">&quot;C&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;D&quot;</span>, <span class="at">effect =</span> <span class="st">&quot;direct&quot;</span></span>
<span id="cb254-3"><a href="causal-inference.html#cb254-3" tabindex="-1"></a>)</span>
<span id="cb254-4"><a href="causal-inference.html#cb254-4" tabindex="-1"></a><span class="fu">adjustmentSets</span>(</span>
<span id="cb254-5"><a href="causal-inference.html#cb254-5" tabindex="-1"></a>  g, <span class="at">exposure =</span> <span class="st">&quot;C&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;D&quot;</span>, <span class="at">effect =</span> <span class="st">&quot;total&quot;</span></span>
<span id="cb254-6"><a href="causal-inference.html#cb254-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Thus, for total effect estimation one should adjust for <span class="math inline">\(X\)</span> and either <span class="math inline">\(Y\)</span> or <span class="math inline">\(S\)</span>, whereas for direct effect estimation, one would also need to adjust for <span class="math inline">\(Z\)</span>.</p>
<p>You can verify that, these are the variables that will block all open paths from <span class="math inline">\(C\)</span> to <span class="math inline">\(D\)</span>.</p>
<p><strong>Now try to do the <em>beer-weight</em> exercise using <em>dagitty</em>: </strong></p>
<ul>
<li><p>Create the DAG and plot it</p></li>
<li><p>What are the paths from WEIGHT to BEER?</p></li>
<li><p>Will you get the same recommendation for the adjustment variable selection as you found before?</p></li>
</ul>
</div>
<div id="instrumental-variables-estimation-mendelian-randomization" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Instrumental variables estimation: Mendelian randomization<a href="causal-inference.html#instrumental-variables-estimation-mendelian-randomization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose you want to estimate the effect of Body Mass Index (BMI) on blood glucose level (associated with the risk of diabetes).
Let’s conduct a simulation study to verify that when the exposure-outcome association is confounded, but there is a valid instrument (genotype), one obtains an unbiased estimate of the causal effect.</p>
<ul>
<li>Start by generating the genotype variable as <em>Binomial(2,p)</em>, with <span class="math inline">\(p=0.2\)</span> (and look at the resulting genotype frequencies):</li>
</ul>
<div class="sourceCode" id="cb255"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb255-1"><a href="causal-inference.html#cb255-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb255-2"><a href="causal-inference.html#cb255-2" tabindex="-1"></a>mrdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">G =</span> <span class="fu">rbinom</span>(n, <span class="dv">2</span>, <span class="fl">0.2</span>))</span>
<span id="cb255-3"><a href="causal-inference.html#cb255-3" tabindex="-1"></a><span class="fu">table</span>(mrdat<span class="sc">$</span>G)</span></code></pre></div>
<ul>
<li>Also generate the confounder variable U</li>
</ul>
<div class="sourceCode" id="cb256"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb256-1"><a href="causal-inference.html#cb256-1" tabindex="-1"></a>mrdat<span class="sc">$</span>U <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
<ul>
<li>Generate a continuous (normally distributed) exposure variable <span class="math inline">\(BMI\)</span> so that it depends on <span class="math inline">\(G\)</span> and <span class="math inline">\(U\)</span>.
Check with linear regression, whether there is enough power to get significant parameter estimates.<br />
For instance:</li>
</ul>
<div class="sourceCode" id="cb257"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb257-1"><a href="causal-inference.html#cb257-1" tabindex="-1"></a>mrdat<span class="sc">$</span>BMI <span class="ot">&lt;-</span> <span class="fu">with</span>(mrdat, <span class="dv">25</span> <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> G <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n))</span></code></pre></div>
<ul>
<li>Finally generate <span class="math inline">\(Y\)</span> (“Blood glucose level”) so that it depends on <span class="math inline">\(BMI\)</span> and <span class="math inline">\(U\)</span> (but not on <span class="math inline">\(G\)</span>).</li>
</ul>
<div class="sourceCode" id="cb258"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb258-1"><a href="causal-inference.html#cb258-1" tabindex="-1"></a>mrdat<span class="sc">$</span>Y <span class="ot">&lt;-</span> </span>
<span id="cb258-2"><a href="causal-inference.html#cb258-2" tabindex="-1"></a>  <span class="fu">with</span>(mrdat, <span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> BMI <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<ul>
<li>Verify, that simple regression model for <span class="math inline">\(Y\)</span>, with <span class="math inline">\(BMI\)</span> as a covariate, results in a biased
estimate of the causal effect (parameter estimate is different from what was generated)</li>
</ul>
<p>How different is the estimate from 0.1?</p>
<ul>
<li><p>Estimate a regression model for <span class="math inline">\(Y\)</span> with two covariates, <span class="math inline">\(G\)</span> and <span class="math inline">\(BMI\)</span>. Do you see a significant effect of <span class="math inline">\(G\)</span>?
Could you explain analytically, why one may see a significant parameter estimate for <span class="math inline">\(G\)</span> there?</p></li>
<li><p>Find an IV (instrumental variables) estimate, using G as an instrument, by following the algorithm
in the lecture notes (use two linear models and find a ratio of the parameter estimates).
Does the estimate get closer to the generated effect size?</p></li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb259-1"><a href="causal-inference.html#cb259-1" tabindex="-1"></a>mgx <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> G, <span class="at">data =</span> mrdat)</span>
<span id="cb259-2"><a href="causal-inference.html#cb259-2" tabindex="-1"></a><span class="fu">ci.lin</span>(mgx) <span class="co"># check the instrument effect</span></span>
<span id="cb259-3"><a href="causal-inference.html#cb259-3" tabindex="-1"></a>bgx <span class="ot">&lt;-</span> mgx<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="co"># save the 2nd coefficient (coef of G)</span></span>
<span id="cb259-4"><a href="causal-inference.html#cb259-4" tabindex="-1"></a>mgy <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> G, <span class="at">data =</span> mrdat)</span>
<span id="cb259-5"><a href="causal-inference.html#cb259-5" tabindex="-1"></a><span class="fu">ci.lin</span>(mgy)</span>
<span id="cb259-6"><a href="causal-inference.html#cb259-6" tabindex="-1"></a>bgy <span class="ot">&lt;-</span> mgy<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb259-7"><a href="causal-inference.html#cb259-7" tabindex="-1"></a>causeff <span class="ot">&lt;-</span> bgy <span class="sc">/</span> bgx</span>
<span id="cb259-8"><a href="causal-inference.html#cb259-8" tabindex="-1"></a>causeff <span class="co"># closer to 0.1?</span></span></code></pre></div>
<ul>
<li>A proper simulation study would require the analysis to be run several times, to see the extent of variability in the parameter estimates.
A simple way to do it here would be using a <code>for</code>-loop. Modify the code as follows (exactly the same commands as executed so far, adding a few lines of code to the beginning and to the end):</li>
</ul>
<div class="sourceCode" id="cb260"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb260-1"><a href="causal-inference.html#cb260-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb260-2"><a href="causal-inference.html#cb260-2" tabindex="-1"></a><span class="co"># initializing simulations:</span></span>
<span id="cb260-3"><a href="causal-inference.html#cb260-3" tabindex="-1"></a><span class="co"># 30 simulations (change it, if you want more):</span></span>
<span id="cb260-4"><a href="causal-inference.html#cb260-4" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb260-5"><a href="causal-inference.html#cb260-5" tabindex="-1"></a>mr <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim) <span class="co"># empty vector for the outcome parameters</span></span>
<span id="cb260-6"><a href="causal-inference.html#cb260-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) { <span class="co"># start the loop</span></span>
<span id="cb260-7"><a href="causal-inference.html#cb260-7" tabindex="-1"></a>  <span class="do">## Exactly the same commands as before:</span></span>
<span id="cb260-8"><a href="causal-inference.html#cb260-8" tabindex="-1"></a>  mrdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">G =</span> <span class="fu">rbinom</span>(n, <span class="dv">2</span>, <span class="fl">0.2</span>))</span>
<span id="cb260-9"><a href="causal-inference.html#cb260-9" tabindex="-1"></a>  mrdat<span class="sc">$</span>U <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb260-10"><a href="causal-inference.html#cb260-10" tabindex="-1"></a>  mrdat<span class="sc">$</span>BMI <span class="ot">&lt;-</span> </span>
<span id="cb260-11"><a href="causal-inference.html#cb260-11" tabindex="-1"></a>    <span class="fu">with</span>(mrdat, <span class="dv">25</span> <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> G <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb260-12"><a href="causal-inference.html#cb260-12" tabindex="-1"></a>  mrdat<span class="sc">$</span>Y <span class="ot">&lt;-</span> </span>
<span id="cb260-13"><a href="causal-inference.html#cb260-13" tabindex="-1"></a>    <span class="fu">with</span>(mrdat, <span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> BMI <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb260-14"><a href="causal-inference.html#cb260-14" tabindex="-1"></a>  mgx <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> G, <span class="at">data =</span> mrdat)</span>
<span id="cb260-15"><a href="causal-inference.html#cb260-15" tabindex="-1"></a>  bgx <span class="ot">&lt;-</span> mgx<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb260-16"><a href="causal-inference.html#cb260-16" tabindex="-1"></a>  mgy <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> G, <span class="at">data =</span> mrdat)</span>
<span id="cb260-17"><a href="causal-inference.html#cb260-17" tabindex="-1"></a>  bgy <span class="ot">&lt;-</span> mgy<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb260-18"><a href="causal-inference.html#cb260-18" tabindex="-1"></a>  <span class="co"># Save the i&#39;th parameter estimate:</span></span>
<span id="cb260-19"><a href="causal-inference.html#cb260-19" tabindex="-1"></a>  mr[i] <span class="ot">&lt;-</span> bgy <span class="sc">/</span> bgx</span>
<span id="cb260-20"><a href="causal-inference.html#cb260-20" tabindex="-1"></a>} <span class="co"># end the loop</span></span></code></pre></div>
<p>Now look at the distribution of the parameter estimate:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb261-1"><a href="causal-inference.html#cb261-1" tabindex="-1"></a><span class="fu">summary</span>(mr)</span></code></pre></div>
<ul>
<li>(<em>optional</em>) Change the code of simulations so that the assumptions are violated: add a weak direct effect of the genotype G to the equation that generates <span class="math inline">\(Y\)</span>:</li>
</ul>
<div class="sourceCode" id="cb262"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb262-1"><a href="causal-inference.html#cb262-1" tabindex="-1"></a>mrdat<span class="sc">$</span>Y <span class="ot">&lt;-</span> </span>
<span id="cb262-2"><a href="causal-inference.html#cb262-2" tabindex="-1"></a>  <span class="fu">with</span>(</span>
<span id="cb262-3"><a href="causal-inference.html#cb262-3" tabindex="-1"></a>    mrdat, </span>
<span id="cb262-4"><a href="causal-inference.html#cb262-4" tabindex="-1"></a>    <span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> BMI <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> U <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> G <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb262-5"><a href="causal-inference.html#cb262-5" tabindex="-1"></a>  )</span></code></pre></div>
<p>Repeat the simulation study to see, what is the bias in the average estimated causal effect of <span class="math inline">\(BMI\)</span> on <span class="math inline">\(Y\)</span>.</p>
<ul>
<li>(<em>optional</em>) Using library <code>sem</code> and function <code>tsls</code>, one can obtain a two-stage least squares estimate for the<br />
causal effect and also the proper standard error. Do you get the same estimate as before?</li>
</ul>
<div class="sourceCode" id="cb263"><pre class="sourceCode r custom-source"><code class="sourceCode r"><span id="cb263-1"><a href="causal-inference.html#cb263-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;sem&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">&quot;sem&quot;</span>)</span>
<span id="cb263-2"><a href="causal-inference.html#cb263-2" tabindex="-1"></a><span class="fu">library</span>(sem)</span>
<span id="cb263-3"><a href="causal-inference.html#cb263-3" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">tsls</span>(Y <span class="sc">~</span> BMI, <span class="sc">~</span>G, <span class="at">data =</span> mrdat))</span></code></pre></div>
<p>(There are also several other R packages for IV estimation and Mendelian Randomization (<em>MendelianRandomization</em> for instance))</p>
</div>
<div id="why-are-simulation-exercises-useful-for-causal-inference" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Why are simulation exercises useful for causal inference?<a href="causal-inference.html#why-are-simulation-exercises-useful-for-causal-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we simulate the data, we know the data-generating mechanism and the <em>true</em> causal effects. So this is a way to check, whether
an analysis approach will lead to estimates that correspond to what is generated. One could expect to see similar phenomena in real
data analysis, if the data-generation mechanism is similar to what was used in simulations.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="poisson-regression-analysis-of-curved-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SPE-R/SPE/edit/master/pracs-book/causal-e.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SPE-R-2024-practicals.pdf", "SPE-R-2024-practicals.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
